#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin /home/amurali/Desktop/DRARM_Thesis_2024/Thesis_draft/
\textclass report
\begin_preamble
\usepackage{lmodern}
\usepackage{xcolor}
\usepackage{subfig}
\usepackage{tikz}
\setcounter{chapter}{2}

%\begin{document}
\usetikzlibrary{decorations.pathmorphing}
\usetikzlibrary{shapes.misc}

\usepackage{xcolor}
\definecolor{BLACK}{rgb}{0,0,0}
\end_preamble
\use_default_options false
\master Thesis_Manuscript_ARM.lyx
\begin_modules
theorems-ams
theorems-ams-extended
\end_modules
\maintain_unincluded_children false
\language english
\language_package none
\inputencoding utf8
\fontencoding default
\font_roman "beraserif" "default"
\font_sans "default" "default"
\font_typewriter "beramono" "default"
\font_math "auto" "auto"
\font_default_family rmdefault
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures false
\graphics default
\default_output_format default
\output_sync 1
\bibtex_command bibtex
\index_command default
\float_placement th
\paperfontsize 12
\spacing onehalf
\use_hyperref true
\pdf_title "PhD Thesis Draft"
\pdf_author "Ama Roy Murali"
\pdf_subject "Noise prediction for high lift devices"
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder false
\pdf_colorlinks true
\pdf_backref false
\pdf_pdfusetitle true
\pdf_quoted_options "linkcolor=red, urlcolor=blue, citecolor=blue, pdfstartview={FitH}, hyperfootnotes=false, unicode=true"
\papersize a4paper
\use_geometry true
\use_package amsmath 2
\use_package amssymb 2
\use_package cancel 0
\use_package esint 1
\use_package mathdots 2
\use_package mathtools 2
\use_package mhchem 0
\use_package stackrel 0
\use_package stmaryrd 0
\use_package undertilde 0
\cite_engine natbib
\cite_engine_type numerical
\biblio_style unsrtnat
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date true
\justification true
\use_refstyle 0
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 3cm
\rightmargin 2.5cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 2
\paperpagestyle fancy
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Chapter
Lattice Boltzmann Method for Computational Aeroacoustics 
\begin_inset CommandInset label
LatexCommand label
name "chap:Lattice-Boltzmann-Method"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
LBM for Aeroacoustics 
\end_layout

\end_inset


\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
The first objective of this thesis is to concoct a suitable framework that
 will enable the investigation of slat noise phenomena numerically.
 Due to the inherent complexity of accelerated shear flow along the curved
 path through slat gap and the impingement of the flow past the sharp edges
 of both the slat cusp and the trailing edge, the flow itself necessitates
 a high-fidelity simulation that can capture unsteady evolution of shear
 layer and its dynamic interactions.
 The three dimensional aspect of flow has also not been investigated in
 detail so far, although the flow features are acknowledged to have strong
 three dimensionality from early studies
\begin_inset CommandInset citation
LatexCommand citep
key "Khorrami2006,Choudhari2007,Manoha2012"
literal "false"

\end_inset

.
 This is due to the fact that the spanwise homogeneity is assumed to be
 sufficient in explaining the major phenomena of the 2D shear layer evolution
 and related Rossiter mechanism
\begin_inset CommandInset citation
LatexCommand citep
key "HamiltonSmith2024"
literal "false"

\end_inset

.
 However, the observed far-field sound clearly suggests that there can be
 unexplored mechanisms arising possibly from the three dimensionality underlying
 the stochastic nature of its tones
\begin_inset CommandInset citation
LatexCommand citep
key "Jawahar2021"
literal "false"

\end_inset

.
 Moreover, any estimation of the farfield sound using time-averaged computation
 of the flow will also introduce modelling errors that will prevent a deeper
 investigation of the flow dynamics.
 Hence our first choice is to obtain a three-dimensional compressible unsteady
 simulation framework that will enable direct simulation of the source mechanism
s.
\end_layout

\begin_layout Standard
A detailed investigation of flow and acoustics within the slat cavity will
 also need a parametric variation of the slat positioning.
 Since the vortices from the shear layer and their evolution along their
 trajectory in the cove plays the major role in the acoustic generation
 mechanism
\begin_inset CommandInset citation
LatexCommand citep
key "Terracol2016"
literal "false"

\end_inset

, variation of the shear layer shape with respect to the slat positioning
 has to be documented in order to form a deeper understanding.
 To enable this, the first difficulty is in generating meshes inside the
 cove geometry.
 The mesh has to be adapted in case of parametric slat positions and hence
 an extensive exploration is not possible unless automatic mesh generation
 is enabled.
 Additionally, the noise generation in the slat cove needs to be captured
 with high fidelity in all cases computed and needs to be propagated without
 numerical loss and artifacts to a far-field observer.
 This requires that the mesh choices must enable accurate source modelling
 together with wave propagation with low numerical dissipation and dispersion,
 and at minimal computational cost.
 
\end_layout

\begin_layout Standard
Among a few advanced techniques in modern CFD, this case thus falls under
 the scope of a wall-modelled Large Eddy Simulation (WMLES).
 It utilities a wall-modeling approach for the boundary layer near the walls
 and deploys a well resolved mesh that can capture the scales of interest
 for the slat cove while modelling the sub-grid scale behaviors.
 This has been shown to be an effective approach for detailed investigation
 of slat noise for a select geometrical configuration, and complicated meshing
 procedures were surmounted by manual effort
\begin_inset CommandInset citation
LatexCommand citep
key "Choudhari2011"
literal "false"

\end_inset

.
 This is also the same scenario if a Direct Numerical Simulation (DNS) has
 to be deployed but only with much larger computational costs which, however,
 will provide the same level of fidelity regarding the noise phenomena
\begin_inset CommandInset citation
LatexCommand citep
key "Moreau2022a"
literal "false"

\end_inset

.
 Hence the canonical wall-resolved LES and DNS are not viable in our study
 which aims to obtain an extensive dataset by variation of slat position.
\end_layout

\begin_layout Standard
A more advanced technique has been deployed in the recent years which uses
 the Lattice Boltzmann framework to obtain an equivalent WMLES.
 It has been demonstrated that this method sufficiently captures the noise
 mechanisms and the propagation effects.
 Here, Very Large Eddy Simulations (VLES) were introduced for slat noise
 simulations by 
\begin_inset CommandInset citation
LatexCommand citet
key "Satti2012"
literal "false"

\end_inset

 and was taken further into high-fidelity simulations in the work of 
\begin_inset CommandInset citation
LatexCommand citet
key "Souza2019"
literal "false"

\end_inset

.
 They deployed the commercial Lattice Boltzmann software PowerFLOW to demonstrat
e that this class of simulations indeed enabled simulations of the slat
 noise phenomena to a high level of accuracy.
 These LBM frameworks natively uses a Cartesian mesh necessitated by the
 voxel based discretisation together with an Immersed Boundary model
\begin_inset CommandInset citation
LatexCommand citep
key "Astoul2021,Feng2019"
literal "false"

\end_inset

.
 Using this technique, the wall geometry is placed in a volume discretized
 using cubic elements and the wall model is used to estimate the conditions
 at the first cell.
 With a sufficient resolution specified to the region near the boundary,
 the meshing procedure is thus fully automated while varying the slat positions.
 This enables to eliminate inconsistencies arising from the manual meshing
 of the geometries and allows a coherent analysis.
 Another factor that advocates for the LBM approach for aeroacoustics is
 its low numerical and dissipation characteristics.
 The LBM formalism implicitly generates a scheme which has a low numerical
 dissipation and can be finely controlled using its modelling parameters.
 This enables accurate propagation of the generated acoustics to far-field
 observer.
 
\end_layout

\begin_layout Standard
Hence the expedited meshing procedure and low numerical dissipation characterist
ics of LBM places the same as a niche technique to be useful in a detailed
 study of slat aeroacoustics.
 It was thus chosen for the progress of our work.
 We now look into a detailed view of the LBM framework for its theoretical
 developments before delineating the methods that we use to adapt a commercial
 LBM software 
\emph on
ProLB
\emph default
 for our slat noise investigation.
\end_layout

\begin_layout Section
A brief overview of the Lattice Boltzmann method
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Overview
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The Lattice Boltzmann Method (LBM) arises from the fundamental idea of a
 Lattice Gas Automata, where behavior of a fluid medium is modeled as a
 cellular automation at the kinetic level
\begin_inset CommandInset citation
LatexCommand citep
key "Frisch1986"
literal "false"

\end_inset

.
 In this perspective, the fluid consist of particles – not exactly the physical
 idea of molecules, which would have been called a molecular level description
 of the fluid – that can interact with each other to exchange momentum such
 that their aggregate behavior is consistent with the kinetic theory of
 gases
\begin_inset CommandInset citation
LatexCommand citep
key "Feng2010"
literal "false"

\end_inset

.
 This intermediate scale of momentum interactions are referred to as the
 mesoscopic scale and is the domain where LBM is formulated.
 The fluidic behavior is then modeled on a discrete lattice in space by
 time-stepping the properties of the lattices depending on its current state
 and the state of its immediate neighbors.
 This means that by a suitable choice of the state variables and a physically
 consistent model for interaction of the cells, the macroscopic behavior
 of a fluid medium can be simulated.
 Since evolution of each lattice is driven by its own state and those of
 its immediate neighbors, the heaviest calculations are local and the method
 can be designed to be massively parallel with limited overhead due to transfer
 of data between parallel processors
\begin_inset CommandInset citation
LatexCommand citep
key "Kruger2017"
literal "false"

\end_inset

.
 This resonates well with the burgeoning of high-performance computing architect
ures and Graphics Processing Units (GPUs) available in modern scientific
 computing especially in the field of Computational Fluid Dynamics (CFD)
 in application to High-Fidelity (Hi-Fi) simulation of turbulence.
 Its applications are hence growing in a wide range of topics including
 aeronautics research, multi-phase flows, and medical hemodynamics.
\end_layout

\begin_layout Standard
\begin_inset Note Comment
status open

\begin_layout Plain Layout
For simulating a fluid using LBM, the first assumption is that the fluid
 behavior can be modeled using probability density functions representing
 the discretized particle velocity vector.
 This means that the velocity of the fictitious particles are discretized
 in terms of its directions from the center node of a lattice to each of
 its nodes, and each of the component is not represented as a deterministic
 quantity but rather by means of a probability density distribution.
 Each of these velocity directions then aids as a channel of interaction
 of the particles between one lattice and its neighbors.
 Given that these velocities are represented by PDFs, the statistical moments
 of these PDFs can be shown to be the equivalent of the density and momentum
 of the macroscopic fluid particles represented by groups of such particles.
\end_layout

\end_inset

Looking at it more formally, the total number of particles in a fluidic
 medium located at a position 
\begin_inset Formula $x$
\end_inset

 with a microscopic particle velocity 
\begin_inset Formula $\xi$
\end_inset

 at a time instant 
\begin_inset Formula $t$
\end_inset

 can be written as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
dN=f_{N}(\boldsymbol{x},\boldsymbol{\xi},t)\mathrm{d}\boldsymbol{x}\mathrm{d}\boldsymbol{\xi}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $f_{N}(\boldsymbol{x},\boldsymbol{\xi},$
\end_inset

t) denotes the particle density probability distribution as a function of
 
\begin_inset Formula $\boldsymbol{x}$
\end_inset

, 
\begin_inset Formula $\boldsymbol{\xi}$
\end_inset

, and 
\begin_inset Formula $t$
\end_inset

, and 
\begin_inset Formula $dx$
\end_inset

 is a mesoscopic spatial volume around the position 
\begin_inset Formula $\boldsymbol{x}$
\end_inset

.
 If the particles have identical mass 
\begin_inset Formula $m$
\end_inset

, then the mass density distribution becomes 
\begin_inset Formula $mf_{N}$
\end_inset

.
 Using such a probability density function, the local fluid density can
 be represented as its zeroth order statistical moment.
 Similarly the higher order moments lead to momentum density 
\begin_inset Formula $\rho\mathbf{u}(\boldsymbol{x},t)$
\end_inset

 and total energy density 
\begin_inset Formula $\rho E(\boldsymbol{x},t)$
\end_inset

.
 These can be written as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\rho(\boldsymbol{x},t)=\int_{\mathbb{R}^{D}}f(\boldsymbol{x},\boldsymbol{\xi},t)\mathrm{d}\boldsymbol{\xi}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\rho\mathbf{u}(\boldsymbol{x},t)=\int_{\mathbb{R}^{D}}\boldsymbol{\xi}f(\boldsymbol{x},\boldsymbol{\xi},t)\mathrm{d}\boldsymbol{\xi}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\rho E(\boldsymbol{x},t)=\int_{\mathbb{R}^{D}}\frac{|\boldsymbol{\xi}|^{2}}{2}f(\boldsymbol{x},\boldsymbol{\xi},t)\mathrm{d}\boldsymbol{\xi}
\end{equation}

\end_inset

The total energy of a kinetic gas, 
\begin_inset Formula $\rho E(\boldsymbol{x},t)$
\end_inset

, is the sum of its internal energy, 
\begin_inset Formula $\rho e(\boldsymbol{x},t)$
\end_inset

, and its kinetic energy, 
\begin_inset Formula $\frac{1}{2}\rho|\boldsymbol{u}(\boldsymbol{x},t)|^{2}$
\end_inset

 , and the former is linked to the variance of the velocity distribution
 providing the formula for the thermodynamic temperature of the fluid as
\begin_inset Formula 
\begin{equation}
T(\boldsymbol{x},t)=\frac{e(\boldsymbol{x},t)}{c_{v}}=\frac{1}{\rho c_{v}}\int_{\mathbb{R}^{D}}\frac{|\boldsymbol{\xi}-\boldsymbol{u}|^{2}}{2}f(\boldsymbol{x},\boldsymbol{\xi},t)\mathrm{d}\boldsymbol{\xi}
\end{equation}

\end_inset

where 
\begin_inset Formula $c_{v}$
\end_inset

 is the isochoric specific heat capacity.
 The fluid pressure can now be obtained from the perfect gas law as
\begin_inset Formula 
\begin{equation}
p(\boldsymbol{x},t)=\rho(\boldsymbol{x},t)r_{g}T(\boldsymbol{x},t)
\end{equation}

\end_inset

where 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $r_{g}$
\end_inset

 is the thermodynamic gas constant in accordance with the kinetic theory
 of gases.
 The discrete particle velocity distribution function in a lattice is hence
 sufficient to retrieve the macroscopic quantities of the fluid.
 The interaction of the particle velocity distribution function, 
\begin_inset Formula $f$
\end_inset

, between the lattices needs to be modeled in such a way that the macroscopic
 fluid behavior is in accordance with the Navier-Stokes equations.
 This is achieved by utilizing the Boltzmann equation and the collision
 operator therein.
 The Boltzmann equation itself determining the time evolution of the particle
 distribution function is written as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial f}{\partial t}+\boldsymbol{\xi}\cdot\frac{\partial f}{\partial\boldsymbol{x}}=\Omega(f)\label{eq:boltzmann_eqn}
\end{equation}

\end_inset

where the left hand side is a convection equation for the particle velocity
 distribution whereas the right-hand term 
\begin_inset Formula $\Omega(f)$
\end_inset

, the collision operator, is the term driving the convection of these probabilit
ies.
 On constraining the collision process model such that the mass, momentum,
 and total energy, of the fluid is conserved during such a process, 
\begin_inset CommandInset citation
LatexCommand citet
key "Bhatnagar1954"
literal "false"

\end_inset

 showed that the primal effect of the collision operator is to shift the
 state of particle velocity distribution to that of the thermodynamic equilibriu
m of the fluid i.e.
 the Boltzmann equation in each time step operates on the particle velocity
 distribution to relax it towards the thermodynamic equilibrium.
 A linearisation of the collision operator was made possible by simplifying
 the collision process as a direct and simpler form of `relaxation' of a
 given particle density function to its thermodynamic equilibrium.
 This relaxation step using a single timestep for the Bhatnagar-Gross-Krook
 (BGK) model writes
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\Omega^{BGK}(\mathbf{x},t)=-\frac{1}{\tau}\left(f(\mathbf{x},t)-f^{(0)}(\mathbf{x},t)\right)
\end{equation}

\end_inset

where 
\begin_inset Formula $\tau$
\end_inset

 is the relaxation time, and 
\begin_inset Formula $f_{i}^{(0)}$
\end_inset

 is the thermodynamic equilibrium distribution function given by Maxwell-Boltzma
nn distribution
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
f^{(0)}=\frac{\rho}{\left(2\pi r_{g}T\right)^{D/2}}\exp\left(-\frac{\|\boldsymbol{\xi}-\boldsymbol{u}\|^{2}}{2r_{g}T}\right)
\end{equation}

\end_inset

As such, such an equilibrium function depends on the local density, temperature,
 and the macroscopic velocity.
 The equilibrium function can hence be computed based on the current local
 state of the particle distribution 
\begin_inset Formula $f$
\end_inset

, but however not completely.
 On analyzing 
\begin_inset Formula $f^{(0)}$
\end_inset

, it can be obtained that
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\int_{\mathbb{R}^{D}}f^{(0)}\mathrm{d}\boldsymbol{\xi}=\rho(\boldsymbol{x},t)
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\int_{\mathbb{R}^{D}}\boldsymbol{\xi}f^{(0)}\mathrm{d}\boldsymbol{\xi}=\rho\mathbf{u}(\boldsymbol{x},t)
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{1}{2}\int_{\mathbb{R}^{D}}|\boldsymbol{\xi}|^{2}f^{(0)}\mathrm{d}\boldsymbol{\xi}=\rho E(\boldsymbol{x},t)=\frac{D}{2}\rho r_{g}T(\boldsymbol{x},t)+\frac{1}{2}\rho|\boldsymbol{u}(\boldsymbol{x},t)|^{2}\label{eq:traceeqn}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
i.e.
 zeroth order moment, first order moment, and the trace of the second order
 moments, of the equilibrium distributions are exactly the same as that
 of the local particle velocity distribution 
\begin_inset Formula $f$
\end_inset

.
 However, only the trace of the latter, i.e.
 the total energy obeys this conformity as written in Eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:traceeqn"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The deviatoric part of the energy tensor, linked to the internal energy,
 and subsequently all higher order moments of the equilibrium distribution
 are not accurately recoverable from the local particle velocity distribution
 only.
 This means that an approximation of the equilibrium distribution based
 solely on the non-equilibrium distribution will introduce an error to the
 deviatoric part of the energy equation, although the total energy conservation
 will still be valid.
 This necessitates a modelling approach in such a way that a model for the
 equilibrium distribution will enable exact recovery of the full Navier-Stokes.
\end_layout

\begin_layout Standard
As a step towards the formalism to approximate the equilibrium distribution
 based solely on the current particle distribution function, Hilbert introduced
 an asymptotic expansion of the latter around the former, i.e.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
f=f^{(0)}+\epsilon f^{(1)}+\epsilon^{2}f^{(2)}+\ldots=\sum_{k=0}^{k=\infty}\epsilon^{k}f^{(k)}\label{eq:asymptoticexp}
\end{equation}

\end_inset

where 
\begin_inset Formula $\epsilon$
\end_inset

 denotes the Knudsen number.
 The Knudsen number denotes the spatial rarity of the fluid particles and
 formally has the definition as a dimensionless number being the ratio of
 the mean free path of the particles to a characteristic length scale 
\begin_inset Formula $l_{0}$
\end_inset

.
 It can typically be translated into a ratio of corresponding time scales
 as,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\epsilon=\frac{\mathcal{L}}{l_{0}}=\frac{\tau_{0}\sqrt{r_{g}T_{0}}}{l_{0}}=\frac{\tau_{0}}{t_{0}}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathcal{L}=\tau_{0}\sqrt{r_{g}T_{0}}$
\end_inset

 is the mean free path since 
\begin_inset Formula $\sqrt{r_{g}T_{0}}$
\end_inset

 is the isothermal sound speed at a reference temperature 
\begin_inset Formula $T_{0}$
\end_inset

, 
\begin_inset Formula $\tau_{0}$
\end_inset

 is the mean time between collisions, and 
\begin_inset Formula $t_{0}$
\end_inset

 is some characteristic time of the flow.
\end_layout

\begin_layout Standard
Chapman and Enskog independently developed this approximation further under
 the constraint that the particle distribution 
\begin_inset Formula $f$
\end_inset

 depends solely on the macroscopic moments.
 They also proposed an expansion of the time derivative based on the order
 of Knudsen number, written as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial}{\partial t}=\sum_{k=0}^{k=\infty}\epsilon^{k}\frac{\partial}{\partial t^{(k)}}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Now that an approximate relation between the non-equilibrium and equilibrium
 distribution is available, it is possible to analyze the behavior of the
 Lattice Boltzmann Equation in its fidelity to the Navier-Stokes behavior.
 For this, the asymptotic expansion in Eq.
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:asymptoticexp"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is substituted to the Boltzmann equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:boltzmann_eqn"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 We omit the actual algebra here further for sake of brevity.
 The zeroth, first, and second order moments, of the resulting equation
 will then correspond to the mass continuity, momentum conservation, and
 the energy equations, respectively.
 Here, different choices of the truncation of the expansion of equilibrium
 distribution based on the order for Knudsen number leads to different set
 of equations.
 When the expansion is truncated after first order for the Knudsen number,
 the exact Navier-Stokes equations can be retrieved.
 If only the expansion is truncated at zeroth order of 
\begin_inset Formula $\epsilon$
\end_inset

, the inviscid Euler equation is obtained.
 Hence at low Knudsen number, typically 
\begin_inset Formula $\epsilon<10^{-2}$
\end_inset

, which is true for widely most cases of practical application including
 aeronautics and aeroacoustics, the Boltzmann equation retrieves the Navier-Stok
es behavior while using the BGK collision model.
\end_layout

\begin_layout Standard
Additionally, in order to recover the Navier-Stokes behavior, it is necessary
 to use the expansion of the non-equilibrium distribution upto first order
 in Knudsen number.
 Then to obtain the energy equation, the second order moment of the equation
 needs to be recovered which means that the first order moment of the non-equili
brium distribution and the fourth order moment of the equilibrium distribution
 will be necessary.
 Moments of the particle velocity distribution are typically computed using
 numerical quadratures in order to obtain the exact integral.
 
\color black
Here typically, LBM utilizes the Gauss-Hermite quadratures for this purpose.
 Hence, since a fourth order moment of the equilibrium distribution has
 to be computed using the Gauss-Hermite quadrature over the discrete space
 of the particle velocity vector, this will impose conditions for sufficient
 discretisation of the velocity vector in a lattice.
 In the language of Gauss-Hermite quadrature, to obtain exact integrals
 for the fourth order moment of a distribution, a quadrature of accuracy
 of order 9 needs to be employed.
 Such quadratures require a minimum of 103 discrete velocities in a 3D lattice.
 Each discrete velocity equation will require one equation to be solved
 and hence will require 103 equations to be solved per lattice per time
 step to advance the time step alone.
 This is computationally expensive although the calculation is local and
 can hence be parallelized.
 To find a compromise and design fast-LB schemes, the heat equation in the
 Navier-Stokes is ignored assuming that the simulated case is athermal.
 In this case, only the third order moment of the equilibrium distribution
 is necessary to recover the exact formulations of the momentum equations
 alone.
 Thus from the relaxed requirement for the computation of the quadratures,
 a lower number of discrete velocities is required.
 Here the minimum number of discrete velocities is 39 for the 3D lattice
 and is more affordable than the previous case.
 A detailed comparison of the schemes and formulations can be found in the
 doctoral thesis of 
\begin_inset CommandInset citation
LatexCommand citet
key "Astoul2021"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
A further compromise that can be made is that a reasonable error in the
 Navier-Stokes momentum equation can be tolerated.
 In this setting, the computation of moments of the equilibrium distribution
 upto second order is shown to generate an error term in the recovered momentum
 equation that is of 
\begin_inset Formula $\text{\mathcal{O}\left(M^{3}\right)}.$
\end_inset

 Second order moments can be calculated on a 3D lattice using the Gauss-Hermite
 quadratures using a minimum of 19 discrete velocities and results in a
 quadrature with an order of accuracy of 5.
 This leads to the most popular lattice used in the LBM solvers, namely
 the D3Q19, and also to the hydrodynamic limits for the computation using
 fast LBM solvers as for those with low Mach numbers, typically 
\begin_inset Formula $M<0.4$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Feng2010"
literal "false"

\end_inset

.
\end_layout

\begin_layout Section
Discrete LBM solvers and Aeroacoustics
\begin_inset CommandInset label
LatexCommand label
name "sec:Numerical-errors"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Aeroacoustics
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Comment
status open

\begin_layout Plain Layout
The Lattice Boltzmann Method (LBM) is an increasingly popular alternative
 to solving the Navier-Stokes equations for fluid simulations that uses
 a mesoscopic description for the fluid's behavior.
 The fluid particle behavior is modeled using probability density functions
 representing the discretized particle velocity vector, together with an
 appropriate collision model to capture their interaction behavior.
 On rigorous analysis using suitable collision models, the exact compressible
 Navier-Stokes equations can be recovered from the Boltzmann equation.
 Nevertheless, truncation errors arising from the approximations of the
 equilibrium distributions limits its fidelity and hence fast LB schemes
 including 
\series bold
\shape italic
ProLB
\series default
\shape default
 are usually limited to weakly compressible isothermal flows , i.e.
 for low Mach number flows typically with 
\begin_inset Formula $M<0.4$
\end_inset

.
\end_layout

\end_inset

 LBM also has specific advantages in view of aeroacoustics.
 
\begin_inset CommandInset citation
LatexCommand citet
key "Marie2009"
literal "false"

\end_inset

 studied in detail the wave dispersion and dissipation of LBM schemes in
 comparison with canonical schemes used for isothermal Navier-Stokes equation.
 Their work suggested that lattice Boltzmann schemes, which including the
 Bhatnagar-Gross-Krook (BGK) and Multi-Relaxation Time (MRT) collision models,
 have better dissipation performance when compared to high-order discretisation
 schemes typically used for Navier-Stokes, i.e.
 for propagating waves through the fluidic medium using a discrete mesh.
 LBM schemes better preserve the wave energy across the discretised medium
 than Navier-Stokes solvers for a comparable grid size.
 In this regard, LBM models with the MRT scheme were also shown to be more
 dissipative than with the BGK model.
 Conversely, LBM schemes experience a larger dispersion.
 In their work, 
\begin_inset CommandInset citation
LatexCommand citet
key "Marie2009"
literal "false"

\end_inset

 compared the dispersion performance of LBM schemes to that of a second
 order finite difference scheme with a 3-step Runge-Kutta algorithm.
 However, the degree of parallelism and the speed of calculation enabled
 by LBM schemes are higher than high-order schemes for a given dispersion
 error.
 Moreover, with their lower dissipation, LBM schemes are much more stable
 than Navier-Stokes solvers with high order optimized schemes.
 These properties related to wave propagation makes LBM-CFD a prudent choice
 for aeroacoustic applications
\begin_inset CommandInset citation
LatexCommand citep
key "Moreau2022a"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
That being said, to use LBM for practical applications involving complex
 geometries, one bottleneck to overcome is the high number of nodes driven
 by the shape constraint of the lattice.
 In LBM, the lattices are so far required to have an aspect ratio of 1 to
 maintain integrity of its theoretical guarantees.
 This means that to resolve the boundary layer of the fluid over a given
 solid wall surface, the near wall cells also needs to be cubical.
 In conventional CFD, the near wall elements are made to have a very high
 aspect ratio such that the resolution in the normal direction to the wall
 is sufficiently high, while that parallel to the wall is maintained low,
 enabling a significant reduction of the total number of nodes in the mesh.
 The assumptions of the boundary layer allow this geometric shortcut without
 reducing the fidelity of the simulation as well.
 However this method cannot be utilized in the LBM simulations and in cases
 where the boundary layer behavior are important, the number of nodes in
 the simulation grows rapidly.
\end_layout

\begin_layout Standard
Such a limitation introduces the requirement of mesh coarsening in practical
 LBM solvers much like in conventional solvers.
 The strategy is to contain the region of high resolution close to the wall
 geometry and to allow the mesh to be coarsened depending on the distance.
 In LBM, this coarsening is done by a factor of 2 in each direction where
 a larger mesh cell adjacent to a finer cell will have twice the side length,
 thus maintaining the cubic shape in both blocks.
 The cell nodes that are adjacent can be made to be congruent at the coarsening
 interface or an interpolation scheme can be used to use hanging nodes,
 which would be placed on a cell edge rather than being a common node between
 the cells.
 The latter introduces more flexibility but introduces an additional source
 of error due to the accuracy for the interpolations.
 In the solver used for our work, 
\series bold
\shape italic
ProLB, 
\series default
\shape default
the mesh coarsening technique used is the first one, i.e.
 with common nodes between adjacent cells on either side of a coarsening
 interface.
 However, the collision model in LBM utilizes information from the adjacent
 cells in its computation.
 This means that a change in cell size introduces errors into the simulation,
 with a strong detrimental effect onto the acoustic field due to the fact
 that acoustic perturbations are of similar amplitude as the mesh coarsening
 errors.
 The problem is exacerbated by the low dissipative nature of the LBM scheme
 as spurious fluctuations propagate through the domain without being dissipated
 near its sources.
 The mesh coarsening interfaces are hence thought of as sources of 'spurious
 noise' in the language of aeroacoustics.
\end_layout

\begin_layout Standard
These errors in the 
\shape italic
ProLB
\shape default
 framework were studied in detail in the work of 
\begin_inset CommandInset citation
LatexCommand citet
key "Astoul2020"
literal "false"

\end_inset

.
 According to their work, the problem fundamentally arises from the fact
 that the constraints applied to LBM equations to recover the hydrodynamic
 behavior is not sufficient to obtain the equilibrium distributions correspondin
g to all the elements of the discrete velocity space.
 The dynamics of the additional unconstrained degrees of freedoms are not
 directly connected to the hydrodynamic behavior through the derivation
 of Navier-Stokes from Lattice Boltzmann Equation.
 This feeds the so called non-hydrodynamic modes, or ghost modes 
\begin_inset CommandInset citation
LatexCommand citep
key "Benzi1990,Benzi1992"
literal "false"

\end_inset

, and can generate fluctuations which can be amplified by numerical errors
 arising from discretisation.
 These modes need to be adequately modelled.
 Hence accumulation of their errors eventually pollute the numerical solution
 with spurious vorticity and acoustic-like modes at grid refinements.
 In the work of 
\begin_inset CommandInset citation
LatexCommand citet
key "Astoul2020"
literal "false"

\end_inset

, these modes were detected and particularly identified using sensors in
 the LBM simulation.
 They were then systematically suppressed using improvements in the collision
 model formulation and the resulting Hybrid-Recursive Regularization (HRR)
 scheme was then used to replace the MRT scheme in the solver 
\shape italic
ProLB
\shape default
.
 This method hence guaranteed a reduction of such spurious noise generation
 in the versions of 
\emph on
ProLB
\emph default
  used in our work.
 
\end_layout

\begin_layout Section
Acoustic Test Case using an Unsteady Compressible Perturbation
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Acoustic Test Case
\end_layout

\end_inset


\end_layout

\begin_layout Standard
As a pilot study to test the effective numerical performance of 
\shape italic
ProLB
\shape default
, a classical test to assess the dissipation and dispersion performance
 was done using a planar Gaussian pulse.
 For this, a one dimensional Gaussian pulse with a pressure amplitude of
 
\begin_inset Formula $100\,\text{Pa}$
\end_inset

 was initialized over an otherwise quiescent initial state.
 
\shape italic
ProLB
\shape default
 was then used to advance the solution in time to propagate the pulse for
 a distance of 
\begin_inset Formula $1\,\text{m}$
\end_inset

.
 Analysis of the pulse in the Fourier domain then allows estimating the
 dissipation and dispersion effects for relevant Fourier components.
 To quantitatively study this case, we follow the analysis by Bres et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Bres2009"
literal "false"

\end_inset

 and consider the propagation of a plane wave in a viscous medium.
 The analytical solution of a plane wave propagating according to the linearized
 NS equation is described in Appendix A, showing the effect of viscosity
 on the wave's dissipation and dispersion.
 When the associated propagation equation is solved on a discretized mesh,
 the effective dissipation and dispersion is accounted for by an additional
 numerical viscosity.
 The solution for a plane wave pulse propagating into a direction x is described
 hereafter along with the numerical dissipation and dispersion.
\end_layout

\begin_layout Standard
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
Accordingly, the linearized Navier-Stokes equation that captures the adiabatic
 sound propagation in an isothermal fluid and assuming a plane wave solution
 leads to the dispersion relation 
\begin_inset Formula $\left(c_{0}^{2}-i\hat{\omega}2\nu\right)\hat{k}^{2}=\hat{\omega}^{2}$
\end_inset

.
\end_layout

\begin_layout Plain Layout
For spatial analysis, a real frequency can be specified to obtain complex
 spatial wave number 
\begin_inset Formula $\hat{k}=\pm\frac{\omega}{\sqrt{c_{0}^{2}-i\omega2\nu}}$
\end_inset

.
 The phase velocity is then given by 
\begin_inset Formula $c_{S}=\omega/Re(\hat{k})$
\end_inset

 and the spatial dissipation rate as 
\begin_inset Formula $\alpha_{S}=Im(\hat{k})$
\end_inset

, thereby yielding the form of a propagating 1D wave solution as
\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{equation}
P^{\prime}(x,t)=\hat{A}\exp\left(-\alpha_{S}x\right)\exp\left[i\omega\left(x/c_{S}-t\right)\right]\label{eq:wavesolution}
\end{equation}

\end_inset


\end_layout

\begin_layout Plain Layout
where 
\begin_inset Formula $c_{S}$
\end_inset

 and 
\begin_inset Formula $\alpha_{s}$
\end_inset

 are the physical phase speeds and dissipation factor for each frequency
 as obtained from the Navier-Stokes behavior.
 By including additional factors to account for numerical dissipation and
 dispersion in the LBM solver such that 
\begin_inset Formula $\alpha_{s}^{total}=\alpha_{s}+\alpha_{s}^{num}$
\end_inset

 and 
\begin_inset Formula $c_{s}^{total}=c_{s}+c_{s}^{num}$
\end_inset

 and comparing Fourier transform of the above solution at different mesh
 locations, their effective values are obtained as
\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{equation}
\alpha_{S}^{\text{num}}(\omega,x)=-\frac{1}{x}\ln\left|\frac{\hat{P}^{\prime}(x,\omega)}{\hat{P}^{\prime}(0,\omega)}\right|-\alpha_{S}\text{\hspace{1em} and \hspace{1em}}c_{s}^{\text{num}}(\omega,x)=\omega x\left(Arg\left(\frac{\hat{P}^{\prime}(x,\omega)}{\hat{P}^{\prime}(0,\omega)}\right)\right)^{-1}-c_{S}\label{eq:numerical_coeffs}
\end{equation}

\end_inset


\end_layout

\begin_layout Plain Layout
The numerical dispersion and dissipation curves obtained according to Eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:numerical_coeffs"
plural "false"
caps "false"
noprefix "false"

\end_inset

) for a propagation distance of 1m, corresponding to frequencies up to 10~kHz
 and for different mesh sizes are shown in Figure ??.
 Small negative values of 
\begin_inset Formula $\alpha_{s}^{num}$
\end_inset

 are visible between 1~kHz and 8~kHz for 
\begin_inset Formula $\Delta x\ge0.002\,$
\end_inset

m, corresponding to 17 points per wavelength at 10~kHz.
 Nevertheless, this effect does not lead to a divergence in actual simulation.
 The numerical dissipation at 10~kHz is less than 0.1
\backslash
,dB/m for the same grid resolution and incur dispersion with less than 0.5
\backslash
% variation in phase speed.
 A similar but better resolution of 
\begin_inset Formula $0.0016\text{m}$
\end_inset

 corresponding to a multiple of boundary layer mesh sizing of 
\begin_inset Formula $0.0002\text{m}$
\end_inset

 is hence chosen for the propagation of acoustic waves in the High-Lift
 Device (HLD) simulations up to the Ffowcs Williams–Hawkings recording surface.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Comment
status collapsed

\begin_layout Section
Turbulent Boundary Layer simulation with 
\emph on
ProLB
\emph default
 
\end_layout

\begin_layout Plain Layout
The 
\emph on
ProLB
\emph default
 solver 
\begin_inset CommandInset citation
LatexCommand citep
key "Feng2021"
literal "false"

\end_inset

 chosen for this work utilizes Lattice Boltzmann method for simulation of
 flow acoustics.
 The solver is fine tuned for acoustic computations by realizing low dissipation
 and dispersion at manageable grid sizes and many recent theoretical advances
 for the LBM solver have also been pushed into production
\begin_inset CommandInset citation
LatexCommand citep
key "Astoul2020,Astoul2021a,Astoul2021"
literal "false"

\end_inset

.
 As part of efforts in line of this work, multiple simulations using updated
 
\emph on
ProLB
\emph default
  solver was also conducted by collaborators on the same VALIANT geometry
 to compare with experimental data.
 It has shown remarkable accuracy in capturing the tonal noise, for both
 frequency and SPL, and is demonstrated to be particularly good for capturing
 the tonal noise.
 A comparison between experimental and simulation results for farfield noise
 spectra are shown in Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:WP_Results_from_ProLB-1-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Plain Layout
An in-house exploratory study for various factors affecting the simulation
 were also studied.
 The first is the classical dispersion and dissipation test for convection
 of acoustic pulses.
 In comparison to previous result available for the LBM solver PowerFLOW,
 the current solver showed similar dissipation and dispersion characteristics.
 The low dissipation enables the solver to be used for Direct Noise Computation
 in terms of numerical accuracy.
 A comparison of various test cases can be seen in Fig.??.
 Nevertheless the applicability for DNC is limited by huge mesh sizes.
 A Ffowcs-Williams routine 
\begin_inset CommandInset citation
LatexCommand citep
key "Bres"
literal "false"

\end_inset

 will instead be used to obtain the farfield noise spectra from near-field
 unsteady flow recordings.
\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/amurali/Desktop/DRARM_Thesis_2024/processes/chapter04/BLRx13S2/Boundary Layer Thickness plot.png
	lyxscale 10
	width 7.75cm
	height 7.75cm
	keepAspectRatio

\end_inset

 
\begin_inset Graphics
	filename /home/amurali/Desktop/DRARM_Thesis_2024/processes/chapter04/BLRx13S2/Wall Law comparison.png
	lyxscale 10
	width 7.75cm
	height 7.75cm
	keepAspectRatio

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Left: Stream wise velocity distribution used to calculate the TBL thickness
 growth compared against the result from Michel's correlation
\begin_inset CommandInset citation
LatexCommand citep
key "Tani1969"
literal "false"

\end_inset

 showing under developed turbulent boundary layer solution.
 Right: Velocity distribution as a function of distance from wall in non
 dimensional wall units 
\begin_inset Formula $u^{+}$
\end_inset

 and 
\begin_inset Formula $y^{+}$
\end_inset

 as compared to an analytical wall model showing the optimal distance for
 first cell size as between 
\begin_inset Formula $100<y^{+}<300$
\end_inset

.
 The analytical model shown is a standard wall model in commercial solvers
 and not the one used in the 
\emph on
ProLB
\emph default
  solver.
 Exact information is not available.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/amurali/Desktop/DRARM_Thesis_2024/processes/chapter04/BLRx13S2/Delta1 and Delta2 Comparison.png
	lyxscale 15
	width 7.75cm
	height 7.75cm
	keepAspectRatio

\end_inset

 
\begin_inset Graphics
	filename /home/amurali/Desktop/DRARM_Thesis_2024/processes/chapter04/BLRx13S2/Shape Factor Comparison.png
	lyxscale 15
	width 7.75cm
	height 7.75cm
	keepAspectRatio

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Left: The turbulent boundary layer characteristics, displacement thickness
 
\begin_inset Formula $\delta_{1}$
\end_inset

and momentum thickness 
\begin_inset Formula $\delta_{2}$
\end_inset

 as compared to the Michel's empirical model 
\begin_inset CommandInset citation
LatexCommand citep
key "Tani1969"
literal "false"

\end_inset

.
 Right: Corresponding comparison of shape factor with theoretical value
 of 1.4.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Caption Standard

\begin_layout Plain Layout
Tripped Turbulent Boundary Layer (
\begin_inset Formula $Re_{x}=1.3M$
\end_inset

) simulation results using 
\emph on
ProLB
\emph default
  solver showing evidence of underdeveloped tripped TBL thickness.
 An excessive viscosity due to the SISM turbulence model is suspected to
 be the issue 
\begin_inset CommandInset label
LatexCommand label
name "fig:Tripped-Turbulent-Boundary"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
A second numerical test was targeted at the wall modelling behavior of the
 solver.
 An LBM scheme essentially consist of voxels which are cubic mesh elements.
 Since their aspect ratio is always equal to 1, the boundary layer resolution
 at 
\begin_inset Formula $y^{+}<5$
\end_inset

 require huge number of voxels and is cost prohibitive.
 Hence wall modelling approach is a necessity for affordable LBMs.
 However, the wall modelling in 
\emph on
ProLB
\emph default
  solver is still under active development and has been tested in-house.
 The test results show that there is an under prediction of turbulence generatio
n leading to a underdeveloped turbulent boundary layer thickness.
 The results for a boundary layer simulation for distance based Reynolds
 number upto 1.3M is shown in Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Tripped-Turbulent-Boundary"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 For the airfoil simulation cases, this means that the flow separation phenomena
 is not well captured.
 These will manifest as a deviation of the predicted Cp value distribution
 over the geometry from that of experiments.
 Nevertheless, since our flow regime of interest does not have large flow
 separations and slat noise mechanisms are not largely affected by separation
 phenomena except slight possible deviations for flow around the cusp, this
 effect is neglected with caution.
\end_layout

\begin_layout Plain Layout
A third test was done to study the behavior of turbulence that crosses mesh
 refinements in the domain.
 Since 
\emph on
ProLB
\emph default
  uses voxels as mesh elements, the mesh refinements are done by a constant
 factor of 2.
 Hence the sudden cell size growth introduces error in the numerical gradient
 calculations.
 With the default version of the solver available, it was found that there
 is considerable dispersion error for acoustic pulses crossing refinement
 regions.
 Various mechanisms has also been identified in the literature whereby an
 LBM scheme can produce spurious waves in the solution due to passage of
 physical and non-physical fluxes through the refinements
\begin_inset CommandInset citation
LatexCommand citep
key "Astoul2020"
literal "false"

\end_inset

.
 These spurious sources were then traced to the error in calculation of
 collision term.
 To reduce such errors, latest updates of the solver employs the Hybrid
 Recursive Regularized schemes
\begin_inset CommandInset citation
LatexCommand citep
key "Feng2019"
literal "false"

\end_inset

 together with direct grid coupling techniques
\begin_inset CommandInset citation
LatexCommand citep
key "Astoul2021a"
literal "false"

\end_inset

.
 Nevertheless, these updates remains to be tested in-house for the purpose
 of this work and current progress is made in the anticipation that future
 releases of the solver will include the updates by default.
\end_layout

\begin_layout Plain Layout
In summary, although pitfalls were identified where the solver has issues
 in boundary layer modelling and spurious noise generation due to grid refinemen
ts, the deficiencies appears not affect the acoustic predictions by large.
 The solver is able to produce results that agree well with experimental
 data for far-field noise, especially in capturing the tonal and broadband
 noise as shown in Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:WP_Results_from_ProLB-1-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Nevertheless, a variation of 
\begin_inset Formula $\pm2$
\end_inset

dB can be found on average throughout the predictions for high frequency
 ranges but these levels are much weaker than the tones.
 In addition, both experimental and simulation data can be used in the dataset
 where results with varying result for the same case will be treated as
 noise in data by the Bayesian module.
 An opportunity of weighted averaging and other hyper parameter tuning can
 be used to introduce bias in the model to improve congruence with experiments.
\end_layout

\begin_layout Plain Layout
A first step towards the automated LBM simulation from input variable was
 also completed as it is essential for the active learning procedure.
 A pre-processing module which takes the slat and main element geometries
 to generate a geometrical case of LBM simulation was completed successfully.
 Here the slat configuration with respect to the main element is specified
 using a four variable coordinate system popular in the literature
\begin_inset CommandInset citation
LatexCommand citep
key "Lu2021"
literal "false"

\end_inset

, namely the slat gap, slat overlap, and slat deflection angle.
 A third variable for angle of attack determines common orientation of device
 to the flow.
 Sweep angle is omitted in the early version of this procedure.
 In addition to the HLD geometry, the pre-processing module is also enabled
 to generate wall pressure probes and refinement regions suitable for the
 simulation.
 A schematic of the slat coordinate system, and resulting geometries generated
 by the module as shown in Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:coordinates"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:lbmpreout"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Quantifying Numerical Rate of Dissipation and Dispersion
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Dissipation and Dispersion
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The temporal Fourier transform of a selected pulse can be used to characterize
 the dispersion and dissipation.
 For this the pressure time history at an arbitrary location can be expanded
 into Fourier integrals as
\begin_inset Formula 
\begin{equation}
P^{\prime}(x,t)=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{+\infty}\hat{P}^{\prime}(x,\omega)e^{-i\omega t}d\omega
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
From the Fourier transform of the arbitrary solution in Eq.
\begin_inset CommandInset ref
LatexCommand formatted
reference "eq:plane_wave_soln"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the propagated wave will have a local Fourier transform given by 
\begin_inset Formula 
\begin{equation}
\hat{P}^{\prime}(x,\omega)=\hat{P}^{\prime}(0,\omega)\exp\left[-\left(\alpha_{S}+\alpha_{S}^{\text{num }}\right)x\right]\exp\left[i\omega\frac{x}{c_{S}+c_{s}^{\text{num }}}\right]\label{eq:localFT}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
which allows to determine the numerical dissipation rate 
\begin_inset Formula $\alpha_{S}^{\text{num }}$
\end_inset

 and sound speed 
\begin_inset Formula $c_{s}^{\text{num }}$
\end_inset

.
 Here, by taking the amplitude on both sides we obtain
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left|\hat{P}^{\prime}(x,\omega)\right|=\left|\hat{P}^{\prime}(0,\omega)\right|\exp\left[-\left(\alpha_{S}+\alpha_{S}^{\text{num }}\right)x\right]
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
or 
\begin_inset Formula 
\begin{equation}
\alpha_{S}^{\text{num }}(\omega,x)=-\frac{1}{x}ln\left|\frac{\hat{P}^{\prime}(x,\omega)}{\hat{P}^{\prime}(0,\omega)}\right|-\alpha_{S}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
and by taking complex argument on both sides of Eq.
\begin_inset CommandInset ref
LatexCommand formatted
reference "eq:localFT"
plural "false"
caps "false"
noprefix "false"

\end_inset

 we have,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
Arg\left(\hat{P}^{\prime}(x,\omega)\right)=Arg\left(\hat{P}^{\prime}(0,\omega)\right)+\frac{\omega x}{c_{S}+c_{s}^{\text{num }}}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
or
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
c_{s}^{\text{num }}(\omega,x)=\omega x\left(Arg\left(\frac{\hat{P}^{\prime}(x,\omega)}{\hat{P}^{\prime}(0,\omega)}\right)\right)^{-1}-c_{S}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $\alpha_{S}=\omega^{2}\nu/c_{0}^{2}$
\end_inset

 and 
\begin_inset Formula $c_{s}=c_{0}$
\end_inset

 are obtained as described in Appendix A.
 The above equations to calculate the effective numerical dispersion and
 dissipation as a function of position enable us to characterize the wave
 propagation performance of our LBM solver and thereby choose a sufficient
 simulation parameter setting, particularly the required mesh resolutions
 to enable aeroacoustic calculations.
\end_layout

\begin_layout Subsection
Simulation Details
\end_layout

\begin_layout Subsubsection*
Choice of initial pulse
\end_layout

\begin_layout Standard
The Gaussian pulse propagated for the simulation should contain the frequencies
 of interest, i.e.
 the bandwidth of the signal should be at least 
\begin_inset Formula $10\text{\,kHz}$
\end_inset

 in frequency or 
\begin_inset Formula $10^{4}/343=30\,\text{m}^{-1}$
\end_inset

 in the spatial wavenumber domain.
 This is adjusted by choosing a sufficiently small pulse width.
 Here the Fourier bandwidth of a Gaussian pulse varies inversely as pulse
 width with bandwidth of a Dirac Delta function being infinite.
 The selected pulse in spatial domain is plotted in Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:A-Gaussian-pulse"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/amurali/Desktop/DRARM_Thesis_2024/processes/chapter03/scripts/Gaussian Pulse.png
	lyxscale 10
	width 8cm
	height 8cm
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/amurali/Desktop/DRARM_Thesis_2024/processes/chapter03/scripts/Gaussian Pulse FT Spatial.png
	lyxscale 10
	width 8cm
	height 8cm
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
(Left:) Spatial distribution of the initial Gaussian pulse and (Right:)
 its spatial Fourier Transform showing wavenumber contents upto 
\begin_inset Formula $50\text{m}^{-1}$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/amurali/Desktop/DRARM_Thesis_2024/processes/chapter03/scripts/Gaussian Pulse FT Temporal.png
	lyxscale 10
	width 8cm
	height 8cm
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
A Gaussian pulse of pulse width 
\begin_inset Formula $\sigma=0.01$
\end_inset

m in the frequency domain, which is also a Gaussian
\begin_inset CommandInset label
LatexCommand label
name "fig:A-Gaussian-pulse"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
A simple Gaussian pulse in spatial, temporal, and frequency domains
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Following 
\begin_inset CommandInset citation
LatexCommand citet
key "Bres2009"
literal "false"

\end_inset

, we then use the initial pulse at origin with the form
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
P^{\prime}(x,y,z,0)=10^{-3}P_{0}\exp\left(-\ln(2)\frac{x^{2}}{\sigma^{2}}\right)
\end{equation}

\end_inset

where 
\begin_inset Formula $\sigma=0.01\,\text{m}$
\end_inset

 is the pulse width which contains wave numbers upto 
\begin_inset Formula $50\,\text{m}^{-1}$
\end_inset

 and corresponding maximum time-frequency of 
\begin_inset Formula $17\,\text{kHz}$
\end_inset

, which is sufficient in view of slat noise since the interesting frequencies
 are below 
\begin_inset Formula $10\,\text{kHz}$
\end_inset

.
\end_layout

\begin_layout Subsubsection*
Choice of discretisation
\end_layout

\begin_layout Standard
To study the effect of numerical dissipation with respect to mesh sizing
 and to make a choice for the simulation of the slat-airfoil cases, we test
 
\emph on
ProLB
\emph default
  on three relevant cell sizes, i.e.
 for 
\begin_inset Formula $\Delta x\in[0.001,0.002,0.004]$
\end_inset

m.
 This variation then allows to study dispersion sensitivity with respect
 to the number of points per wavelength (
\begin_inset Formula $N_{ppw}$
\end_inset

) given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
N_{ppw}=\frac{\lambda}{\Delta x}=\frac{1}{k\Delta x}
\end{equation}

\end_inset

where k is the wave number 
\begin_inset Formula $\frac{1}{\lambda}$
\end_inset

.
\begin_inset Float table
placement tb
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="5">
<features booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="top" width="0pt">
<column alignment="center" valignment="top" width="0pt">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\downarrow k|\Delta x\rightarrow$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.001m
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.002m
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.004m
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
50 
\begin_inset Formula $m^{-1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
17150 Hz
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
25 
\begin_inset Formula $m^{-1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
40
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8575 Hz
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\begin_inset Formula $m^{-1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
200
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
343 Hz
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3\times10^{-6}$
\end_inset

 s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $6\times10^{-6}$
\end_inset

s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.2\times10^{-5}$
\end_inset

 s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\leftarrow\Delta t|\omega\uparrow$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Number of Points Per Wavelength (PPW) for relevant values of wavenumbers
 and cell sizes.
 Corresponding temporal frequencies and timestep sizes for 
\begin_inset Formula $CFL=1$
\end_inset

 also shown
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Hence the performance of the code with respect to the wave of wavenumber
 of 
\begin_inset Formula $50\,\text{m}^{-1}$
\end_inset

for the case of a resolution of 
\begin_inset Formula $0.001\,\text{m}$
\end_inset

 corresponds to its performance at 20 points per wavelength.
 The wave propagation and its numerical effects are linear in the frequency
 domain – being captured by the linearized Navier-Stokes – and hence the
 behavior of the pulse in the frequency domain is an adequate indicator
 of the LBM code response for each of its Fourier components.
 Thus the same for acoustic waves in an actual simulation when linear acoustics
 are considered to be dominant.
\end_layout

\begin_layout Subsection
Simulation Results
\end_layout

\begin_layout Standard
LBM simulations of the above described acoustic pulse propagation are performed
 using the 
\emph on
ProLB
\emph default
  solver and the results are compared with the cases simulated using PowerFLOW
 as reported in the work of 
\begin_inset CommandInset citation
LatexCommand citet
key "Bres2009"
literal "false"

\end_inset

.
 The propagation of the pulse, starting at the initial position x=0, as
 a time series at different probe locations of the domain, 
\begin_inset Formula $x=[0.1,0.6,1.1]\,m$
\end_inset

 are shown in Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:time_series"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The propagated pulse shows evident dispersion and dissipation for the coarse
 mesh cases 
\begin_inset Formula $\Delta x=0.002\,\text{m}$
\end_inset

 and 
\begin_inset Formula $0.004\,\text{m}$
\end_inset

.
 But the propagation is apparently efficient for the case 
\begin_inset Formula $\Delta x=0.001$
\end_inset

m where the loss in amplitude and dispersion effects are low upto 1m distance
 as we studied.
 A comparison of the cases are shown in Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:time_series"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/amurali/Desktop/DRARM_Thesis_2024/processes/chapter03/sim_results/Detailed_Study_Gaussian_Pulse_1D/PostProc/pp_scripts_advection_gaussian/dx_004 Timeseries Pressure.png
	lyxscale 10
	width 3.1in
	height 3.1in
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Formula $\Delta x=0.004$
\end_inset

m
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/amurali/Desktop/DRARM_Thesis_2024/processes/chapter03/sim_results/Detailed_Study_Gaussian_Pulse_1D/PostProc/pp_scripts_advection_gaussian/dx_002 Timeseries Pressure.png
	lyxscale 10
	width 3.1in
	height 3.1in
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Formula $\Delta x=0.002$
\end_inset

m
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/amurali/Desktop/DRARM_Thesis_2024/processes/chapter03/sim_results/Detailed_Study_Gaussian_Pulse_1D/PostProc/pp_scripts_advection_gaussian/dx_001 Timeseries Pressure.png
	lyxscale 10
	width 3.1in
	height 3.1in
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Formula $\Delta x=0.001$
\end_inset

m
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/amurali/Desktop/DRARM_Thesis_2024/processes/chapter03/sim_results/Detailed_Study_Gaussian_Pulse_1D/PostProc/pp_scripts_advection_gaussian/dx_004 FT Variation 110.png
	lyxscale 10
	width 8cm
	height 8cm
	keepAspectRatio

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Ratio of Fourier amplitudes for case a).
\begin_inset CommandInset label
LatexCommand label
name "fig:ampltiude_ratio"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Caption Standard

\begin_layout Plain Layout
Time history of the propagating pulse at positions downstream of the right
 traveling pulse using 
\emph on
ProLB
\emph default
  simulation with resolution a)
\begin_inset Formula $\Delta x=0.004\,\text{m}$
\end_inset

, b)
\begin_inset Formula $\Delta x=0.002\,\text{m}$
\end_inset

, c)
\begin_inset Formula $\Delta x=0.001\,\text{m}$
\end_inset

.
 The variation of the Fourier transform with respect to propagation distances
 for case a) is shown in d) using the amplitudes of FT as a ratio of its
 initial value.
\begin_inset CommandInset label
LatexCommand label
name "fig:time_series"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Time history of the propagating pulse at positions downstream of the right
 traveling pulse using 
\emph on
ProLB
\emph default
  simulation
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The numerical dissipation coefficient is a function of the frequency or
 the wave number and higher frequencies suffer higher dissipation.
 The inverse is true for dispersion where the higher wave number components
 suffer more from a loss of phase speed.
 Variation of the pulse in the frequency domain as it propagates through
 the mesh illustrates this and is shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:time_series"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The same is shown as a ratio of amplitude of a propagated wave and the
 original wave in Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ampltiude_ratio"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The distribution of rate of dissipation 
\begin_inset Formula $\alpha_{S}^{num}$
\end_inset

 arising from numerical discretisation as obtained according to the spatial
 analysis in 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Spatial-Analysis"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is shown in Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:dissipation_and_dispersion_coefficient"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 As expected, the obtained values follow the trend as described by 
\begin_inset CommandInset citation
LatexCommand citet
key "Bres2009"
literal "false"

\end_inset

 which is shown in Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:bresplot"

\end_inset

.
 Nevertheless, for the 
\emph on
ProLB
\emph default
  result, the slight amplification of the mid-high frequencies are also
 notable as the negative value of 
\begin_inset Formula $\alpha_{S}^{num}$
\end_inset

.
 This means that the waves of these frequencies will show a growth in amplitude
 during the propagation and those at higher frequencies will dissipate,
 both effects amplified when the mesh is coarsened.
 However, we do not notice such growth of amplitude leading to an instability
 in the test case and is thought to be counterbalanced by the viscosity
 at a higher amplitude range.
 Additionally, the cell size chosen for the simulation is close to the finest
 grid in the test which does not exhibit such amplification.
 Finally, from Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:dissipation_and_dispersion_coefficient"
plural "false"
caps "false"
noprefix "false"

\end_inset

, for our frequencies of interest which is less that 
\begin_inset Formula $10\,\text{kHz}$
\end_inset

, it is is deduced that a cell size of 
\begin_inset Formula $0.002\,\text{m}$
\end_inset

 will give a system able to propagate the acoustic waves with a loss of
 approximately 
\begin_inset Formula $0.01\,\text{Np/m}$
\end_inset

.
 This translates to 
\begin_inset Formula $\approx0.09\,\text{dB}$
\end_inset

 reduction in the amplitude of the acoustic wave while propagated through
 a distance of 
\begin_inset Formula $1\,\text{m}$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement tb
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/amurali/Desktop/DRARM_Thesis_2024/processes/chapter03/sim_results/Detailed_Study_Gaussian_Pulse_1D/PostProc/pp_scripts_advection_gaussian/Dispersion - Phase speed Comparison .png
	lyxscale 10
	width 7.5cm
	height 7.5cm
	keepAspectRatio

\end_inset

 
\begin_inset Graphics
	filename /home/amurali/Desktop/DRARM_Thesis_2024/processes/chapter03/sim_results/Detailed_Study_Gaussian_Pulse_1D/PostProc/pp_scripts_advection_gaussian/Dissipation - Rate comparison.png
	lyxscale 10
	width 7.5cm
	height 7.5cm
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The dispersion(left) and dissipation(right) results for an initial acoustic
 Gaussian pulse of amplitude 
\begin_inset Formula $100\text{Pa}$
\end_inset

, (above mean pressure, SPL: 
\begin_inset Formula $134\text{dB}$
\end_inset

) for propagation over 1m using 
\emph on
ProLB
\emph default
 .
 Multiple plots are for multiple minimal voxel sizes of the mesh.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:dissipation_and_dispersion_coefficient"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
The dissipation and dispersion results for an initial acoustic Gaussian
 pulse - ProLB 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
placement tb
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figs/bresresult.png
	lyxscale 70
	width 16cm
	height 16cm
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Caption Standard

\begin_layout Plain Layout
The dispersion(left) and dissipation(right) results for the same case using
 PowerFLOW from the work of 
\begin_inset CommandInset citation
LatexCommand citet
key "Bres2009"
literal "false"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
The dissipation and dispersion results for an initial acoustic Gaussian
 pulse - PowerFlow
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:bresplot"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
Ffowcs Williams-Hawkings Analogy for Far-field Noise
\begin_inset CommandInset label
LatexCommand label
name "sec:FWHsection"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
FWH Analogy 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
As deduced from the direct pulse propagation test case, a mesh size of approxima
tely 
\begin_inset Formula $0.002\,\text{m}$
\end_inset

 meets the criteria for near lossless propagation of the acoustic waves
 upto 10 kHz.
 Nevertheless, the number of voxels in the Cartesian mesh used for LBM simulatio
ns scales with 
\begin_inset Formula $(∆x)^{3}$
\end_inset

 and hence direct noise computation remains expensive.
 Here, a Ffowcs Williams–Hawkings (FWH) analogy
\begin_inset CommandInset citation
LatexCommand citep
key "Williams1969,Greschner2008"
literal "false"

\end_inset

 is used instead for the far-field propagation.
 Being an exact rearrangement of the Navier-Stokes equation in the form
 of a wave equation and by using the free space Green’s function to obtain
 an analytic integral formula for the far field sound, FWH analogy enables
 fast computation of sound at a farfield location.
 For our work, the calculation is coded in the TurbAcAn solver, developed
 at Ecole Centrale de Lyon, based on the advanced time formulation by 
\begin_inset CommandInset citation
LatexCommand citet
key "Casalino2003"
literal "false"

\end_inset

.
 The solver has previously been tested alongside URANS
\begin_inset CommandInset citation
LatexCommand citep
key "Casalino2003a"
literal "false"

\end_inset

 and LES
\begin_inset CommandInset citation
LatexCommand citep
key "Boudet2016"
literal "false"

\end_inset

 applications.
 In the present work, the solver is interfaced with 
\emph on
ProLB
\emph default
  to process the flow recordings a posteriori and simple test cases were
 performed which are detailed in this section.
 Before delineating the Ffowcs Williams-Hawkings implementation, we briefly
 summarize the basic theory first.
\end_layout

\begin_layout Standard
The Ffowcs Williams-Hawkings equation is an exact formulation derived from
 the Navier-Stokes equations in the presence of a stationary or moving body
 in a fluid medium.
 It is obtained using the same approach as for Lighthill's equation in free
 flow, extended to the presence of solid bodies.
 In addition, the variables are defined over the whole space by means of
 the Heaviside function and a characteristic function 
\begin_inset Formula $f$
\end_inset

 that is positive in the flow domain, negative inside the solid and zero
 on the solid boundary.
 The generalized Lighthill's equation thus obtained will have two new source
 terms in addition to the Lighthill's stress tensor.
 The resulting equation is the general Ffowcs Williams-Hawkings equation.
 It takes the form 
\begin_inset Formula 
\[
\left\{ \frac{\partial^{2}}{\partial t^{2}}-c_{0}^{2}\Delta\right\} \left[\rho_{a}H(f)\right]=\frac{\partial^{2}}{\partial x_{i}\partial x_{j}}\left[T_{ij}H(f)\right]-\frac{\partial}{\partial x_{i}}\left[L_{i}\delta(f)\right]+\frac{\partial}{\partial t}[Q\delta(f)]
\]

\end_inset


\end_layout

\begin_layout Standard
Here, 
\begin_inset Formula $H(f)$
\end_inset

 is the Heaviside function vanishing inside the solid body and experiencing
 a jump across the solid surface, 
\begin_inset Formula $\delta(f)$
\end_inset

 is the Dirac Delta function capturing the solid body surface.
 The first term on the right-hand side contains 
\begin_inset Formula $T_{ij}$
\end_inset

 which is the Lighthill's stress tensor written as 
\begin_inset Formula 
\[
T_{ij}=\rho u_{i}u_{j}+p_{ij}-c^{2}\left(\rho-\rho_{0}\right)\delta_{ij}
\]

\end_inset

where 
\begin_inset Formula $i$
\end_inset

 and 
\begin_inset Formula $j$
\end_inset

 are the directional indices and 
\begin_inset Formula $p_{ij}=p\delta_{ij}+\tau_{ij}$
\end_inset

 is the fluid stress tensor.
 Due to the second order derivative, this term represents a quadrupole source.
 
\end_layout

\begin_layout Standard
The formulation has two additional sources on the right-hand side than the
 canonical form of the wave equation due to the treatment of the variables
 using the Heaviside function.
 The first of these, 
\begin_inset Formula $\frac{\partial}{\partial x_{i}}\left[L_{i}\delta(f)\right]$
\end_inset

, is called the loading noise term.
 It involves a first order spatial derivative over the surface and is hence
 a dipole source term.
 The term 
\begin_inset Formula $L_{i}$
\end_inset

 can be obtained as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}L_{i} & =\left[\rho u_{i}\left(u_{j}-u_{j}^{\Sigma}\right)+P_{ij}\right]n_{j}\end{aligned}
\]

\end_inset

where 
\begin_inset Formula $n_{j}$
\end_inset

 is the surface unit normal vector, 
\begin_inset Formula $u^{\Sigma}$
\end_inset

 is the velocity vector of the surface in case of a moving surface, and
 
\begin_inset Formula $P_{ij}$
\end_inset

 is same as the stress tensor 
\begin_inset Formula $p_{ij}$
\end_inset

.
 The difference of notation between 
\begin_inset Formula $P_{ij}$
\end_inset

 and 
\begin_inset Formula $p_{ij}$
\end_inset

 is canonically used to differentiate the context of source integration,
 where 
\begin_inset Formula $p_{ij}$
\end_inset

 contributes as a volume stress tensor in the Lighthill term while 
\begin_inset Formula $P_{ij}$
\end_inset

 contributes only as the surface stress or traction via 
\begin_inset Formula $P_{ij}n_{j}$
\end_inset

 in the loading noise term.
 In the inviscid case, both 
\begin_inset Formula $p_{ij}$
\end_inset

 and 
\begin_inset Formula $P_{ij}$
\end_inset

 reduce to 
\begin_inset Formula $p\delta_{ij}$
\end_inset

, and the surface traction simplifies to 
\begin_inset Formula $P_{ij}n_{j}=pn_{i}$
\end_inset

, i.e.
 the wall-normal pressure component.
 
\end_layout

\begin_layout Standard
The second additional term, 
\begin_inset Formula $\frac{\partial}{\partial t}[Q\delta(f)]$
\end_inset

, is called the thickness noise and captures the mass flow rate fluctuation
 on the surface.
 It is omnidirectional (time derivative) and thus described as a monopole
 term.
 Here 
\begin_inset Formula $Q$
\end_inset

 can be obtained as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}Q & =\left[\rho\left(u_{j}-u_{j}^{\Sigma}\right)+\rho_{\infty}u_{j}^{\Sigma}\right]n_{j}\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
The FWH equation presented here represents the generalized FWH sources.
 When applied to a real solid surface, the wall normal flow velocity 
\begin_inset Formula $u_{j}$
\end_inset

 vanishes and if the solid body is at rest, 
\begin_inset Formula $u^{\Sigma}$
\end_inset

 also vanishes.
 This means that when applied to a solid body surface at rest, the loading
 noise term reduces to 
\begin_inset Formula $L_{i}=P_{ij}n_{j}$
\end_inset

, which under the inviscid assumption further reduces to the wall normal
 pressure loading 
\begin_inset Formula $pn_{i}$
\end_inset

, i.e.
 the fluctuating wall-normal pressure load.
\end_layout

\begin_layout Subsection*
Extension to arbitrary control surfaces
\end_layout

\begin_layout Standard
Both of these sources arise as a mathematical consequence of truncating
 the propagation domain by multiplying with a Heaviside function.
 Differentiation of the Heaviside function generates delta-function terms
 supported on the truncation surface, thereby converting volumetric contribution
s into equivalent surface terms.
 This operation is analogous to Gauss’s divergence theorem, in which the
 effect of a distributed quantity within a volume can be represented as
 a flux through its boundary.
 In the present context, this means that the presence of distributed sources
 inside a volume where acoustic perturbations propagate towards the boundary
 is equivalent to having surface sources on that boundary.
 The best outcome of this technique is that for both loading and thickness
 noise terms, mathematically, their is no direct contribution from inside
 of the control volume since 
\begin_inset Formula $H(f)$
\end_inset

 vanishes inside.
 Thus, instead of calculating the propagation of the sound from the exact
 source point, it is sufficient to have the recordings of their emanating
 wavefronts while they are incident on the chosen surface, and can then
 be used to model the equivalent surface sources for further propagation
 to the farfield.
 This enables to compute the noise generated by turbulence in complex flows
 by recording the emanated wave on an exterior surface surrounding the source
 region which are strongly perturbed by the turbulence in the interior.
 
\end_layout

\begin_layout Standard
Another consequence of the formalism is that the canonical Lighthill's source
 term, 
\begin_inset Formula $\frac{\partial^{2}}{\partial x_{i}\partial x_{j}}\left[T_{ij}H(f)\right]$
\end_inset

, is only dominant in the region of turbulent flows leading to the quadrupole
 source.
 But this source term is vanishing outside the region of active turbulence.
 If thought of as being computed on an imaginary surface enclosing a volume
 region which is first placed inside the turbulent region and then expanded
 towards outside of the active source region, the source energies associated
 with quadrupole source terms inside the volume gets progressively transferred
 to the other two terms by nature of the conservation of momentum itself
 that is causal for the sound radiation.
\end_layout

\begin_layout Subsection*
Solution for the FWH equation
\end_layout

\begin_layout Standard
To obtain a direct formula for the sound propagated to a farfield observer
 from the chosen recording surface, a free space Green's function, typically
 of the form 
\begin_inset Formula $G=\frac{\delta(g)}{r}$
\end_inset

, where 
\begin_inset Formula $\delta(g)$
\end_inset

 is the Dirac function at a source location, 
\begin_inset Formula $g=t-\tau-r/c$
\end_inset

 and 
\begin_inset Formula $r=|\boldsymbol{x}-\boldsymbol{y}|$
\end_inset

, where 
\begin_inset Formula $\boldsymbol{x}$
\end_inset

 is the receiver position, 
\begin_inset Formula $\boldsymbol{y}$
\end_inset

 is the source position, and 
\begin_inset Formula $\tau$
\end_inset

 is the time of emission, is used to convolve with the source term.
 Completing the integral in time along with the properties of 
\begin_inset Formula $\delta$
\end_inset

-function support on the imaginary surface, the sound received at a particular
 observer location 
\begin_inset Formula $\boldsymbol{y}$
\end_inset

 is obtained as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
4\pi p' & =\frac{\partial^{2}}{\partial x_{i}\partial x_{j}}\int_{f>0}\left[\frac{T_{ij}}{r(1-M_{r})}\right]_{ret}dV\nonumber \\
 & -\frac{\partial}{\partial x_{i}}\int_{f=0}\left[\frac{L_{i}}{r(1-M_{r})}\right]_{ret}dS\nonumber \\
 & +\frac{\partial}{\partial t}\int_{f=0}\left[\frac{Q}{r(1-M_{r})}\right]_{ret}dS
\end{align}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $\left[.\right]_{ret}$
\end_inset

denotes the quantities at a retarded time, which is related to current time
 
\begin_inset Formula $t$
\end_inset

 as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\tau_{ret}=t-\frac{|x-y(\tau_{ret})|}{c}
\]

\end_inset

where 
\begin_inset Formula $y(\tau_{ret})$
\end_inset

 is the source position at the retarded time 
\begin_inset Formula $\tau_{ret}$
\end_inset

.
\end_layout

\begin_layout Standard
The integration then leads to the retarded time formulation of the FWH analogy
 called the Farassat's 1A formulation
\begin_inset CommandInset citation
LatexCommand citep
key "Farassat2013"
literal "false"

\end_inset

 with the final form for the thickness noise and loading noise terms as
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
4\pi p_{Q}^{\prime}(\mathbf{x},t) & =\int_{f=0}\left[\frac{\rho_{0}\left(\dot{U}_{n}+U_{\dot{n}}\right)}{r\left(1-M_{r}\right)^{2}}\right]_{ret}\mathrm{~d}S\nonumber \\
 & +\int_{f=0}\left[\frac{\rho_{0}U_{n}\left(r\dot{M}_{r}+c\left(M_{r}-M^{2}\right)\right)}{r^{2}\left(1-M_{r}\right)^{3}}\right]_{ret}\mathrm{~d}S\label{eq:thicknessnoise}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
and
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
4\pi p_{L}^{\prime}(\mathbf{x},t) & =\frac{1}{c}\int_{f=0}\left[\frac{\dot{L}_{r}}{r\left(1-M_{r}\right)^{2}}\right]_{ret}\mathrm{~d}S\nonumber \\
 & +\int_{f=0}\left[\frac{L_{r}-L_{M}}{r^{2}\left(1-M_{r}\right)^{2}}\right]_{ret}\mathrm{~d}S\nonumber \\
 & +\frac{1}{c}\int_{f=0}\left[\frac{L_{r}\left(r\dot{M}_{r}+c\left(M_{r}-M^{2}\right)\right)}{r^{2}\left(1-M_{r}\right)^{3}}\right]_{ret}\label{eq:loadingnoise}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
The quadrupole term remains an integral over the volume and cannot be reduced
 to a surface integral.
 This this term is often omitted in practice on the condition that the Mach
 number is low, although this assumption is still under debate.
 This requirement is met if there is no active turbulence where the surface
 is placed.
\end_layout

\begin_layout Standard
This method leads to the calculation of the sound received by each observer
 at each time step as an integral on the recording surface.
 
\color black
The calculation thus uses the data on the surface locations at a time of
 emission which coincides with the condition that a source emitting sound
 at a particular time will have the wave reaching the observer at the particular
 observer time step, or precisely, the computation time step is the observer's
 time step or the reception time step.

\color brown
 
\color inherit
This retarded time formulation leads the calculation on the surface to be
 done at different source emission times for the same observer time step
 and hence is cumbersome although calculation aposteriori on the recorded
 data has been widely used and proven robust.
 
\begin_inset CommandInset citation
LatexCommand citet
key "Casalino2003"
literal "false"

\end_inset

 gave the alternative definition that improved the numerical efficiency
 of this calculation.
 In his formulation, called the Advanced Time formulation, the calculation
 is instead done for each time step of the data available on the surface.
 Thus the computation time is now the emission time step.
 For this, the relation between reception time, now called the Advanced
 Time, and the emission time is calculated as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
t_{adv}=t+\mathscr{T}
\]

\end_inset

where
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathscr{T}=\frac{\mid\mathbf{x}(t+\mathscr{T})-\mathbf{y}(t)\mid}{c}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
is the time lag between the emission time and the reception time between
 a source at location 
\begin_inset Formula $\mathbf{y}$
\end_inset

 and an observer at location 
\begin_inset Formula $\mathbf{x}$
\end_inset

.
\end_layout

\begin_layout Standard
Using this relation, the farfield sound due the fluctuation on the surface
 from each time step is distributed over the full time domain of listening
 for the observer.
 This enables simpler calculation since the data on surface is now accessed
 sequentially and only the listener time steps need to be calculated for
 each mesh point.
 Also, the data on the surface now requires only to be recorded at the resolutio
n of the observer time step, whereas in retarded time formulation, the requireme
nt of source terms at different emission times implies that the resolution
 of the flow recording had to be higher than the acoustic resolution for
 the observer to avoid errors due to discretisation of the emission times.
 However, in the Advanced Time approach, the distribution of the radiated
 sound on to discrete time steps for listener means that the calculated
 time lag from the source cell to the listener may not always coincide with
 the available discrete time step.
 This will necessitate an interpolation of the received sound.
 Nevertheless, a linear interpolation between two time steps was demonstrated
 to give satisfactory result in the original work of 
\begin_inset CommandInset citation
LatexCommand citet
key "Casalino2003"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
As mentioned, for practical application, Casalino’s Advanced Time formulation
 
\begin_inset CommandInset citation
LatexCommand citep
key "Casalino2003"
literal "false"

\end_inset

 also retain the volume integrals for the quadrupole source terms causing
 a restriction on the placement of the FWH surface.
 In our simulations of the high-lift airfoil, the surface is chosen to surround
 the acoustic sources in the vicinity of the airfoil and is kept far enough
 from the airfoil suction side to avoid strong vortices ejected from the
 slat cove.
 Nevertheless, it is impossible to have a surface that encloses the airfoil
 and does not lead to intersecting wake region downstream of the airfoil.
 Therefore, the surface is kept open downstream of the airfoil, so that
 no vorticity fluctuations are convected through the surface.
 An alternative approach to keeping an open surface is by using averaging
 surfaces in the downstream region where vortices are convected through
\begin_inset CommandInset citation
LatexCommand citep
key "Mendez2013"
literal "false"

\end_inset

.
 We do not choose this approach since our placement of the surface sufficiently
 far from the airfoil and extended downstream is shown to be able to recover
 the slat noise signature with a good agreement with the experiment in our
 validation test.
 The integration surface used for recording unsteady data is shown in Figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:FWHSurfaceplacement"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and the truncated surface used for surface integral calculation is shown
 in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Truncated-surface-used"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 It must be mentioned that some large-size low-vorticity structures still
 approach the upper side of the surface but the generated spurious sound
 sources are negligible.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/amurali/Desktop/My Publications Source Code/AIAA Rome/figs/FWH_Surface2.png
	lyxscale 20
	width 8cm
	height 8cm
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
FWH Surface along with the dilatation field 
\begin_inset CommandInset label
LatexCommand label
name "fig:FWHSurfaceplacement"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Formula $\,\,$
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/amurali/Desktop/My Publications Source Code/AIAA Rome/figs/HLD_With_Surface.png
	lyxscale 20
	width 8cm
	height 8cm
	keepAspectRatio

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Surface is truncated surface with the region in red removed for the calculation
 of the far-field sound 
\begin_inset CommandInset label
LatexCommand label
name "fig:Truncated-surface-used"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
FWH surface placement along with the HLD geometry put into perspective 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Monopole Test case for TurbAcAn
\begin_inset Argument 1
status open

\begin_layout Plain Layout
TurbAcAn (FWH)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
For using FWH analogy and enable far-field noise calculation from the LBM
 simulation data, we used an in-house solver named TurbAcAn.
 The routine written in FORTRAN utilizes a structured Cartesian grid for
 the calculation of the surface integrals mentioned in Eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:thicknessnoise"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:loadingnoise"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Nevertheless, this routine needed to be adapted to read data saved from
 
\emph on
ProLB
\emph default
  solver and we chose to use the XDMF format for the data input pipeline.
 An XDMF file reader was designed to read the data iteratively from memory
 for each time step of the recording and was used to compute the farfield
 sound.
 The following test case was then used to check the accuracy of the code
 and the new file reader.
\end_layout

\begin_layout Standard
For the first test case, we chose to simulate an acoustic monopole using
 the LBM solver 
\emph on
ProLB
\emph default
 .
 For this, a time varying pressure was applied to a spherical geometry of
 suitable size resulting in the radiation of a sound field.
 A spherical FWH surface was then used to record the field at some distance
 around the source.
 The FWH module TurbAcAn was then used to calculate the sound at observer
 positions farther away from the source.
 The radiated field was found in good agreement with the analytical solution
 and also with the recorded field at observer positions by Direct Noise
 Computation (DNC).
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement ph
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/amurali/Desktop/DRARM_Thesis_2024/Image_repo/SphericalPulseTestCaseTurbAcAn2.png
	lyxscale 50
	width 10cm
	height 10cm
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Pulsating source surface (red) simulation showing the spherical wave propagation
 and FWH surface (grey) used for recording flow variables.
\begin_inset CommandInset label
LatexCommand label
name "fig:monopolesource_schematic"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzpicture}
\end_layout

\begin_layout Plain Layout


\backslash
draw[green!50!black,fill=green!20!white, fill opacity=0.5, dashed] (-2.7,-2.7)
 rectangle (2.7,2.7) node[midway, below=21mm] {Uniform Mesh region};
\end_layout

\begin_layout Plain Layout


\backslash
draw[red] (0,0) circle (0.2) node[above=3mm] {Source};
\end_layout

\begin_layout Plain Layout


\backslash
draw[blue, dashed, line width=1mm, ] (0,0) circle (2) node[above=20mm] {porous
 FWH surface};
\end_layout

\begin_layout Plain Layout


\backslash
draw[red,->,decorate,decoration={snake,amplitude=1mm,segment length=1mm}]
 (0.2,0) -- (1.8,0);
\end_layout

\begin_layout Plain Layout


\backslash
draw[black,thick,line width=1.5mm] (-5,-5) rectangle (5,5) node[midway, below=43m
m] {Domain boundaries with absorbing condition};
\end_layout

\begin_layout Plain Layout


\backslash
fill[red] (-3.0, 0.0)  circle (2pt) node[above left]  {P1};
\end_layout

\begin_layout Plain Layout


\backslash
fill[red] (-3.0,-3.0)  circle (2pt) node[below left] {P2};
\end_layout

\begin_layout Plain Layout


\backslash
fill[red] (-4.2, 0.0)  circle (2pt) node[above left]  {P3};
\end_layout

\begin_layout Plain Layout


\backslash
fill[red] (-4.2,-4.2)  circle (2pt) node[below left] {P4};
\end_layout

\begin_layout Plain Layout


\backslash
fill[red] (3.0,  0.0)  circle (2pt) node[above right] {P5};
\end_layout

\begin_layout Plain Layout


\backslash
fill[red] (3.0,  3.0)  circle (2pt) node[above right] {P6};
\end_layout

\begin_layout Plain Layout


\backslash
fill[red] (4.2,  0.0)  circle (2pt) node[above right] {P7};
\end_layout

\begin_layout Plain Layout


\backslash
fill[red] (4.2,  4.2)  circle (2pt) node[above right] {P8};
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzpicture}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Caption Standard

\begin_layout Plain Layout
A 2D schematic of the test case for FWH module 
\shape italic
\emph on
\color black
TurbAcAn showing the probe locations.
 Even numbered probes are not in the same 2D plane during recording and
 exact coordinates are given in Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ResultsTurbAcAn"
plural "false"
caps "false"
noprefix "false"

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:2Dschematicpulsetest"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
FWH surface test case using a pulsating spherical source 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Analytical solution
\end_layout

\begin_layout Standard
For an acoustic Monopole in an otherwise quiescent medium, the pressure
 and velocity perturbations at a distance R from the surface, assuming farfield,
 are given by the equation
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
p(\mathrm{r},t)=\left(\frac{Q_{s}}{r}\right)\sin\left(k(ct-r)\right)=\left(\frac{Q_{s}}{r}\right)\sin\left(\omega(t-r/c)\right)\label{eq:monopole_pressure}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
u(\mathrm{r},t)=\left(\frac{Q_{s}}{\rho cr}\right)\sin(\omega(t-r/c))\label{eq:monopole_velocity}
\end{equation}

\end_inset

where 
\begin_inset Formula $Q_{s}$
\end_inset

 is the strength of the so called Monopole source.
 
\end_layout

\begin_layout Standard
This solution can be used as a forcing agent for the LBM simulation to mimic
 the behavior of a Monopole source.
 But since the flow solver only enables specification of either velocity
 or pressure distribution, we choose the pressure as time varying forcing.
 This also limits the specification of source only as a farfield solution
 since in the near field of a Monopole source, the pressure and velocity
 fluctuations are out of phase, and hence both pressure and velocity need
 to be specified.
 On the other hand, in the farfield, the pressure and velocity oscillations
 are approximately in-phase, and hence a specification of pressure only
 as forcing term leads to velocity fluctuations that are approximately in-phase.
 For the given source frequency of 5000Hz, corresponding Helmholtz number
 is 
\begin_inset Formula $\text{He}=\frac{2\pi f}{c}r$
\end_inset

.
 A source surface of radius 
\begin_inset Formula $0.025\,\text{m}$
\end_inset

 is chosen such that the Helmholtz number of the source surface 
\begin_inset Formula $\text{He_{s}}=\frac{2\pi f}{c}r=\frac{2\pi\times5000}{c}\times0.025=2.29>1.0$
\end_inset

.
 This source surface is shown in red in Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:monopolesource_schematic"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
Following Eq.
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:monopole_pressure"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the effect of point Monopole source at the center of a spherical surface
 of radius 
\begin_inset Formula $r=0.025\text{m}$
\end_inset

 leads to pressure distribution on the surface given by 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
p(\mathrm{0.025},t)=\left(\frac{Q_{s}}{0.025}\right)\sin(2\pi\times5000\times(t-0.025/c))\label{eq:surface_pressure}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Since the pressure on the surface is specified in the 
\emph on
ProLB
\emph default
 solver with the time coordinate 
\begin_inset Formula $t_{s}=t-t_{0}$
\end_inset

, where t is the time coordinate of imaginary monopole source and 
\begin_inset Formula $t_{0}=0.025/c$
\end_inset

 is the time at which the wave reaches the source surface in simulation.
 This surface was used as the forcing surface for a harmonic wave of 
\begin_inset Formula $5000\text{Hz}$
\end_inset

 and amplitude of 
\begin_inset Formula $100\text{Pa}$
\end_inset

 which can be written as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
p(\mathrm{0.025},t_{s})=100\sin(2\pi\times5000\times t_{S})\label{eq:forcing_equation}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
On comparing Eq.
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:surface_pressure"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and Eq.
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:forcing_equation"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we obtain equivalent monopole source amplitude
\begin_inset Formula 
\begin{equation}
\frac{Q_{s}}{0.025}=100\implies Q_{s}=0.025\times100=2.5\text{Pa.m}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Using this value of equivalent monopole strength in Eq.
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:monopole_pressure"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to estimate the amplitude on the FWH surface with radius 
\begin_inset Formula $r=0.2\text{m}$
\end_inset

, we get
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
P(0.2,t_{s})\approx\left(\frac{2.5}{0.2}\right)\sin\left[2\pi\times5000\times\left(t_{s}-\frac{0.2}{c}\right)\right]=12.5\sin\left[2\pi\times5000\times\left(t_{s}-\frac{0.2}{c}\right)\right]
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
However, this amplitude of 
\begin_inset Formula $12.5\text{Pa}$
\end_inset

 is not recovered on the FWH surface during the simulation and observed
 waves tend to have a lower amplitude.
 This owes to the fact that the simulated harmonic pressure source efficiency
 is lower than that of an actual Monopole since the specified boundary condition
s in the LBM setting does not involve specification of the macro-variables
 but that of the particle population densities.
 The latter introduces additional complexity, as mentioned while discussing
 on Eq.
 34 in the work of 
\begin_inset CommandInset citation
LatexCommand citet
key "Wissocq2017"
literal "false"

\end_inset

.
 Hence for the purpose of expediency towards study of acoustics, instead
 of using the explicitly specified source amplitude, the simulated amplitude
 available at the FWH surface is used to estimate the equivalent Monopole
 strength.
 Simulated pressure amplitude on the FWH surface is obtained as 
\begin_inset Formula $6\,\text{Pa}$
\end_inset

 on the spherical surface having a radius 
\begin_inset Formula $r=0.2\text{m}$
\end_inset

.
 i.e.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
P(0.2,t_{s})\approx\left(\frac{Q_{s}}{0.2}\right)\sin\left[2\pi\times5000\times\left(t_{s}-\frac{0.2}{c}\right)\right]=6\sin\left[2\pi\times5000\times\left(t_{s}-\frac{0.2}{c}\right)\right]
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Hence,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left(\frac{Q_{s}}{0.2}\right)=6\implies Q_{s}=1.2\,\text{Pa.m}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Following Eq.
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:monopole_pressure"
plural "false"
caps "false"
noprefix "false"

\end_inset

, corresponding analytical solution for farfield observer at radial distance
 
\begin_inset Formula $R_{obs}$
\end_inset

then writes
\end_layout

\begin_layout Standard
\begin_inset Formula $P(R_{obs},t_{s})\approx\left(\frac{1.2}{R_{obs}}\right)\sin\left[2\pi\times5000\times t_{s}\right]$
\end_inset

 
\end_layout

\begin_layout Standard
This result is used as the analytical solution for comparison in Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ResultsTurbAcAn"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\end_layout

\begin_layout Subsubsection
Choice of time stepping and cell size
\end_layout

\begin_layout Standard
According to 
\begin_inset CommandInset citation
LatexCommand citet
key "Casalino2003"
literal "false"

\end_inset

, the FWH scheme shows phase shifting depending on the time stepping used.
 Accordingly, a timestep corresponding to 75 points per time period of the
 wave is chosen for the first case study.
 Hence for the simulation, a time step 
\begin_inset Formula $\Delta t=2.66\times10^{-6}s$
\end_inset

, corresponding to 75 points for a wave with frequency 5000Hz is used.
\end_layout

\begin_layout Standard
Cell size corresponding to the time step is obtained by setting the cell
 Courant number to 1, which is default for the LBM scheme in 
\emph on
ProLB
\emph default
 , leading to
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\Delta x=c\Delta t\sqrt{3}=343.2\times2.66\times10^{-6}\sqrt{3}=1.58\times10^{-3}\text{m}\approx1.6\text{mm}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The number of points per wavelength for minimal dissipation and dispersion
 in 
\emph on
ProLB
\emph default
  was identified in a previous section.
 Considering that maximum frequency of interest is 10 kHz, a cell size of
 
\begin_inset Formula $0.002\,m$
\end_inset

 was satisfactory.
 This corresponds to a value of 17 points per wavelength.
 The cell size used in current simulation is 1.6mm, and for a frequency of
 
\begin_inset Formula $5000\,\text{Hz}$
\end_inset

 of the source, this correspond to 34 points per wavelength.
\end_layout

\begin_layout Subsubsection
Results
\end_layout

\begin_layout Standard
The spherical wave test case results from the FWH computation were compared
 with the analytical result.
 As shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ResultsTurbAcAn"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the FWH routine implementation provides an accurate computation.
 Here the odd numbered probes are placed in the same 2D center plane as
 the source and the even numbered probes are placed on a diagonal line and
 out of the center plane.
 For all probes, the wave shape, frequency, amplitude, and delay times,
 for different observer locations are found to be in good agreement.
 The computation using the FWH surface are also compared with noise obtained
 at observer positions by direct recording, which is a Direct Noise Computation
 (DNC).
 For the DNC, the recordings shows deviations in the even numbered probes
 placed on the diagonals and also have notable phase variations.
 This is expected since, as shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ResultsTurbAcAn"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the probes are placed outside the first level of refinement and the corner
 nodes at the coarsening distort the propagation of waves as discussed in
 Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Numerical-errors"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 This suggests that the propagation of waves through mesh refinements in
 the 
\emph on
ProLB
\emph default
  solver has room for improvement, particularly at the corner nodes of refinemen
t interfaces.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement ph
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/amurali/Desktop/Shared_Newton/SphericalWaveTestCase/comparison probe:007.png
	lyxscale 10
	width 7.2cm
	height 7.2cm
	keepAspectRatio
	BoundingBox 70bp 0bp 1836bp 1116bp
	clip
	groupId fwh_monopole_result

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Probe P1
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/amurali/Desktop/Shared_Newton/SphericalWaveTestCase/comparison probe:006.png
	lyxscale 10
	width 7.2cm
	height 7.2cm
	keepAspectRatio
	BoundingBox 70bp 0bp 1836bp 1116bp
	clip
	groupId fwh_monopole_result

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Probe P2
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/amurali/Desktop/Shared_Newton/SphericalWaveTestCase/comparison probe:002.png
	lyxscale 10
	width 7.2cm
	height 7.2cm
	keepAspectRatio
	BoundingBox 70bp 0bp 1836bp 1116bp
	clip
	groupId fwh_monopole_result

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Probe P3
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/amurali/Desktop/Shared_Newton/SphericalWaveTestCase/comparison probe:001.png
	lyxscale 10
	width 7.2cm
	height 7.2cm
	keepAspectRatio
	BoundingBox 70bp 0bp 1836bp 1116bp
	clip
	groupId fwh_monopole_result

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Probe P4
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/amurali/Desktop/Shared_Newton/SphericalWaveTestCase/comparison probe:020.png
	lyxscale 10
	width 7.2cm
	height 7.2cm
	keepAspectRatio
	BoundingBox 70bp 0bp 1836bp 1116bp
	clip
	groupId fwh_monopole_result

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Probe P5
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/amurali/Desktop/Shared_Newton/SphericalWaveTestCase/comparison probe:022.png
	lyxscale 10
	width 7.2cm
	height 7.2cm
	keepAspectRatio
	BoundingBox 70bp 0bp 1836bp 1116bp
	clip
	groupId fwh_monopole_result

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Probe P6
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/amurali/Desktop/Shared_Newton/SphericalWaveTestCase/comparison probe:025.png
	lyxscale 10
	width 7.2cm
	height 7.2cm
	keepAspectRatio
	BoundingBox 70bp 0bp 1836bp 1116bp
	clip
	groupId fwh_monopole_result

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Probe P7
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/amurali/Desktop/Shared_Newton/SphericalWaveTestCase/comparison probe:027.png
	lyxscale 10
	width 7.2cm
	height 7.2cm
	keepAspectRatio
	BoundingBox 70bp 0bp 1836bp 1116bp
	clip
	groupId fwh_monopole_result

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Probe P8
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results for pulsating pressure source test case for 
\emph on
TurbAcAn
\emph default
 showing signals obtained at various probe coordinates.
 The inaccuracies arising from propagation of waves by DNC across mesh coarsenin
g can be noted to be larger when the probe is in coarse mesh region.
 FWH recording is done inside the first refinement level and hence remain
 accurate in all cases.
 All coordinates are in meters.
\begin_inset CommandInset label
LatexCommand label
name "fig:ResultsTurbAcAn"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Results for pulsating pressure source test case for TurbAcAn showing signals
 obtained at various probe coordinates
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Validation Case Setup
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Validation Case
\end_layout

\end_inset


\end_layout

\begin_layout Standard
With the aim of running a parametric study on the HLD geometry of slat-airfoil
 configuration, we concocted a template based case setup for the LBM simulation.
 The voxel meshing combined with the immersed boundary method used for the
 
\emph on
ProLB
\emph default
  software enables meshing of the complicated flow domain in the slat cove
 with almost no user intervention during mesh generation and is thus very
 convenient for such a parameterisation.
 In this section, we first explain the choice of parameters that we selected
 for the template, which are the parameters of the LBM case setup for all
 simulations described in this thesis.
 The acoustic computation using FWH is also made part of this template since
 the surface placement can be chosen such that no case specific adjustments
 or repositioning is necessary.
 Following this case setup and injection of the geometries of the airfoil
 and slat, the complete simulation case files are compiled, where the relative
 position of the slat with respect to the main element are varied.
 The latter is then documented and post-processed in the following chapter.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement ph
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzpicture}[scale=1.5]                                     % Draw
 the main square 	
\end_layout

\begin_layout Plain Layout


\backslash
draw (0,0) rectangle (5,5);                                       % Draw
 the rectangles on each side 	
\end_layout

\begin_layout Plain Layout


\backslash
draw[fill=red!50, opacity=0.5] (0,0) rectangle (5,1); 	
\end_layout

\begin_layout Plain Layout


\backslash
draw[fill=red!50, opacity=0.5] (5,5) rectangle (0,4); 	
\end_layout

\begin_layout Plain Layout


\backslash
draw[fill=red!50, opacity=0.5] (1,5) rectangle (0,0); 	
\end_layout

\begin_layout Plain Layout


\backslash
draw[fill=red!50, opacity=0.5] (5,5) rectangle (4,0);             % Side
 labels 	
\end_layout

\begin_layout Plain Layout


\backslash
node at ( 2.50,  -0.20) {
\backslash
scriptsize $L_x=25C$, $P = 101325
\backslash
,
\backslash
text{Pa}$}; 	
\end_layout

\begin_layout Plain Layout


\backslash
node at (-0.36,   2.50) [rotate=90]{
\backslash
scriptsize $L_y=25C$, $U_x = 50
\backslash
,
\backslash
text{m/s}$};
\end_layout

\begin_layout Plain Layout


\backslash
node at ( 5.3,   2.70) [rotate=90]{
\backslash
scriptsize $L_y=25C$, $P = 101325
\backslash
,
\backslash
text{Pa}$}; 	
\end_layout

\begin_layout Plain Layout


\backslash
node at ( 2.50,   5.26) {
\backslash
scriptsize $L_x=25C$, $P = 101325
\backslash
,
\backslash
text{Pa}$};          %Absorbing layer label 	
\end_layout

\begin_layout Plain Layout


\backslash
node at (0.5,  0.2) {
\backslash
scriptsize $2
\backslash
,
\backslash
text{m}$}; 	
\end_layout

\begin_layout Plain Layout


\backslash
node at (0.22,  0.5) {
\backslash
scriptsize $2
\backslash
,
\backslash
text{m}$}; 	
\end_layout

\begin_layout Plain Layout


\backslash
node at (4.78,  4.5) {
\backslash
scriptsize $2
\backslash
,
\backslash
text{m}$}; 	
\end_layout

\begin_layout Plain Layout


\backslash
node at (4.5,  4.8) {
\backslash
scriptsize $2
\backslash
,
\backslash
text{m}$};                        % Draw FWH region 	
\end_layout

\begin_layout Plain Layout


\backslash
draw[fill=green!50, opacity=0.5] (3.2,2.9) rectangle (1.8,2.0);	
\end_layout

\begin_layout Plain Layout


\backslash
node at (2.6,1.8) {
\backslash
scriptsize Res.
 Lvl.
 4 ($
\backslash
Delta x = 1.6
\backslash
,
\backslash
text{mm}$)};     
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzpicture}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename HLD_Main_Slat_Schematic.png
	lyxscale 50
	width 12cm
	height 12cm
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
A schematic of the slat-airfoil geometry showing the slat positioning system
 relative to the main element denoted as the Slat Gap (SGP), Slat Overlap
 (SOL), and Slat Deflection Angle (SDA).
 The coordinate axes used for the simulation are also shown with marking
 of the downstream, cross stream and spanwise directions.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Schematic of the domain, boundary conditions, and the slat-airfoil configuration.
 ).
\begin_inset CommandInset label
LatexCommand label
name "fig:SchematicDomain"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Schematic of the domain, boundary conditions, and the slat-airfoil configuration.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Base template
\end_layout

\begin_layout Standard
To create the base template for the simulation, we utilize the pre-processing
 module LBPre available with 
\emph on
ProLB
\emph default
  suite.
 Following best practices from previous works on HLD using LBM solvers 
\begin_inset CommandInset citation
LatexCommand citep
key "Himeno2021,Souza2019,Satti2012"
literal "false"

\end_inset

, a square domain is selected with an extent of 25C, where 
\begin_inset Formula $C=0.3\text{m}$
\end_inset

 is the stowed chord length of the VALIANT airfoil.
 The boundaries are then supplied with appropriate macro flow variables
 as inlet and outlet boundaries.
 The inlet velocity is 
\begin_inset Formula $50,\text{m/s}$
\end_inset

 for all parametric simulations planned.
 For the outlet and farfield boundaries, a constant Pressure condition of
 101325 Pa is supplied.
 The domain boundaries are then supplanted with 
\begin_inset Formula $2\text{m}$
\end_inset

 of absorbing region with conditions to avoid reflection of the perturbations
 from the boundary.
 The absorbing boundary layers available in 
\emph on
ProLB
\emph default
  provide relaxation parameters to enable compatibility with different boundary
 conditions.
 The relaxation parameters allow the macro-variables to be maintained or
 attenuated by altering the underlying particle populations
\begin_inset CommandInset citation
LatexCommand citep
key "Wissocq2017"
literal "false"

\end_inset

.
 In the case of the inlet velocity boundary, the velocity relaxation targets
 are fixed to the inlet velocity value so that the absorbing layer does
 not attenuate the incoming velocity into the domain.
 To avoid reflection of the pressure waves, the pressure relaxation target
 is set to be Dynamic.
 In the Dynamic setting, the Pressure is relaxed towards the mean thermodynamic
 equilibrium pressure by only attenuating the fluctuating pressure waves.
 This enables a clean and steady inlet velocity boundary condition.
 For the case of three other boundaries, i.e.
 the outlet plane and farfield planes at the pressure and suction side of
 the airfoil, the Pressure value is set to the atmospheric pressure.
 This Dirichlet condition requires that the Pressure field in the absorbing
 region needs to be relaxed to a fixed Pressure.
 Since the outflow is unconstrained, the velocity target is set to be Free,
 meaning that the relaxation of velocity is not performed.
 In the spanwise direction, periodic boundary conditions are applied.
 
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="5">
<features booktabs="true" tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="center" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="center" valignment="top" width="0pt">
<column alignment="center" valignment="top" width="0pt">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Boundary
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Absorbing Layer width
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Type
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean values
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Relaxation Targets
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="left" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Inlet
\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2m
\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="left" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Velocity
\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
50 m/s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Velocity: Fixed
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pressure: Dynamic
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="left" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Outlet
\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2m
\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="left" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pressure
\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
101325 Pa
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Velocity: Free
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pressure: Fixed
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="left" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Top
\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2m
\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="left" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pressure
\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
101325 Pa
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Velocity: Free
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pressure: Fixed
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="left" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bottom
\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2m
\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="left" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pressure
\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="center" valignment="middle" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
101325 Pa
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Velocity: Free
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pressure: Fixed
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Spanwise
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Periodic
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
All variables equated
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Boundary conditions applied for the simulation domain
\begin_inset CommandInset label
LatexCommand label
name "tab:BCsTable"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Spanwise Periodic conditions
\end_layout

\begin_layout Standard
On using periodic conditions for the flow, perturbations in the spanwise
 domain are known for their tendency to foster spatially periodic patterns
 scaling on the span extent and multiples of the associated wave number
 
\begin_inset Formula $2\pi n/L$
\end_inset

 to maintain spanwise correlation as well as to make the flow homogeneous
 over the span avoiding the spontaneous decorrelation of the flow.
 This artificially induced coherence needs to be avoided, particularly in
 view of the aeroacoustic mechanisms involving the role of spanwise coherent
 eddies in the slat cove, by using sufficiently long span length: we choose
 
\begin_inset Formula $L_{z}=0.7C$
\end_inset

 which is significantly higher than that suggested in the work of 
\begin_inset CommandInset citation
LatexCommand citet
key "Choudhari2011"
literal "false"

\end_inset

.
 A template setup consisting of the boundary conditions and refinement regions
 was first generated as shown in Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:SchematicDomain"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and the slat-airfoil geometry was defined to allow for parameter variations.
 Additionally, all flow boundary conditions are coupled with appropriate
 absorbing boundary conditions with a region of influence of about 7C (2
 m).
 The boundaries and applied absorbing layer settings are collected in Table
 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:BCsTable"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
For generating the mesh layout, prudence is given to minimize the number
 of nodes in order to minimize the cost of simulations.
 This enables exploring the parameter space extensively.
 Hence, the meshing is initiated from the domain boundaries with the minimum
 possible cell size, i.e.
 same as spanwise domain length of 
\begin_inset Formula $L_{z}=0.2\,\text{m}=0.66C$
\end_inset

.
 In previous sections, it was shown that to obtain a lossless propagation
 of the acoustics generated by the flow, we need to maintain a resolution
 of 17 points per wavelength and corresponding to the frequencies of interest
 upto 10 kHz, this corresponds to a cell size of approximately 1.6mm.
 Hence, a sub-region of the domain, marked as Resolution Level 4 in the
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:SchematicDomain"
plural "false"
caps "false"
noprefix "false"

\end_inset

, is maintained at this cell-size to enable propagation of the generated
 noise.
 The FWH surface is also placed inside this region to record the perturbations
 so that the input to the FWH calculation does not involve spurious effects
 due to propagation on an unresolved grid.
 The airfoil geometry is then positioned inside the FWH surface.
\end_layout

\begin_layout Subsection
Coordinate System
\end_layout

\begin_layout Standard
The coordinate system of the airfoil for the simulation is chosen such that
 for variation of the angle of attack of the airfoil, the positioning of
 the FWH surface and the meshing on the airfoil does not necessarily change.
 For this we choose to keep the airfoil and FWH in steady position and update
 region of boundary conditions (together with absorbing regions) to reflect
 the change in the flow direction.
 Hence inlet velocity is specified using its vectorial components calculated
 from the required angle of attack with respect to the main element.
\end_layout

\begin_layout Subsection
Meshing
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement tbh
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename chapter03_figs/MeshWhole2.png
	lyxscale 20
	width 8cm
	height 8cm
	keepAspectRatio

\end_inset

 
\begin_inset Graphics
	filename chapter03_figs/Mesh.png
	lyxscale 20
	width 8cm
	height 8cm
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Refinement regions upto 4th level until FWH surface drawn as red line.
 The first level corresponding to wall boundary mesh is close to the wall
 and is not visible.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:VisMEmesh"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename chapter03_figs/SlatCovemesh.png
	lyxscale 20
	width 8cm
	height 8cm
	keepAspectRatio

\end_inset

 
\begin_inset Graphics
	filename chapter03_figs/TEMesh.png
	lyxscale 20
	width 8cm
	height 8cm
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Mesh in the slat cove region showing the first level of refinement corresponding
 to cell size of 
\begin_inset Formula $2\times10^{-4}$
\end_inset

m
\begin_inset space ~
\end_inset

 maintained inside the cove region and around main element trailing edge.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:VisCOVEmesh"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
LBM mesh sizes in the domain and around the HLD geometry
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The boundary layer resolution required to simulate the flow is determined
 by the flow Reynolds number.
 For the case simulated in our work, the chord based Reynolds number is
 around 
\begin_inset Formula $10^{6}$
\end_inset

.
 Based on the slat chord, this corresponds to a Reynolds number of 
\begin_inset Formula $1.3\times10^{5}$
\end_inset

, and hence from the wall 
\begin_inset Formula $y^{+}$
\end_inset

 based on friction velocity, to maintain 
\begin_inset Formula $y^{+}<50$
\end_inset

, a cell size of 0.0003m is required.
 The LES-LBM using 
\emph on
ProLB
\emph default
  utilizes a wall-model based on the logarithmic wall law
\begin_inset CommandInset citation
LatexCommand citep
key "Malaspinas2014,Boudet2022"
literal "false"

\end_inset

.
 When a wall boundary is present with no-slip condition, the boundary nodes
 are provided with additional fictitious particles such that the momentum
 of the particles that would otherwise exit the domain is supplied back
 into the domain.
 This condition is called the bounce back condition
\begin_inset CommandInset citation
LatexCommand citep
key "Gallivan1997"
literal "false"

\end_inset

.
 Although it requires a few additional manipulations, it has shown to be
 sufficient to recover the Navier-Stokes behavior in the boundary layer.
 Additionally, with a Cartesian grid, the wall 
\begin_inset Formula $y^{+}$
\end_inset

 distribution cannot be definitively controlled in an LBM simulation.
 Hence a choice for the case is made by keeping the 
\begin_inset Formula $y^{+}$
\end_inset

 close to 50, where a boundary layer cell size of 
\begin_inset Formula $2\times10^{-4}m$
\end_inset

 is chosen resulting in an effective 
\begin_inset Formula $y^{+}$
\end_inset

 of 35.
 This is based on the expectation that the boundary layer development happens
 along the wall within a length of 
\begin_inset Formula $0.039\text{m}$
\end_inset

, which is the slat chord length.
\end_layout

\begin_layout Standard
With the specification of the near-wall cell size, this property is then
 attributed to the wall geometry.
 The Cartesian meshing algorithm then maintains this cell size in the region
 surrounding the wall and does the same until a few layers of the mesh away
 from the wall.
 The number of layers for our case is set to 6.
 This leads to having 6 layers of the cell size attributed to the solid
 wall around it an then automatic coarsening by factors of two following
 every 6 layers of the cells.
 The blocks of meshes with same sizes thus formed are the so called mesh
 Refinement Levels.
 Starting with the boundary cell size of 0.
\begin_inset Formula $0002\,\text{m}$
\end_inset

 as Refinement Level 1, and coarsening by factor of 2, the resolution as
 required by the acoustic propagation is obtained in Level 4.
 Hence, within the region of Level 4, as shown in the Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:SchematicDomain"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the mesh has 3 sub-levels, the exact shapes of which are primarily dictated
 by the shape of the wall geometry.
\end_layout

\begin_layout Standard
To capture the aeroacoustic phenomena accurately, the slat cove flow has
 to be well resolved since the spanwise coherence of the vortical structures
 and their convection by the mean flow needs adequate fidelity as well as
 the sound back-propagating from the slat trailing edge to its cusp.
 To aid in accurate visualization of the vortices, and to obtain a smooth
 averaging of the flow, we choose to keep the boundary layer cell size constant
 throughout the slat cove.
 The same is also applied to a region downstream of the slat trailing edge
 and also downstream of the main element's trailing edge.
 The resulting mesh around the airfoil is shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:VisMEmesh"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and the mesh in the slat cove is shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:VisCOVEmesh"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The mesh for the current standard positioning of the slat is obtained with
 99 million nodes.
\end_layout

\begin_layout Subsection
Temporal scales
\end_layout

\begin_layout Standard
LBM simulation time steps are primarily determined by the cell sizing.
 This is due to the fact that a fixed Courant–Friedrichs–Lewy (CFL) number,
 is maintained in cell calculation.
 This means that during the timestepping, the time step calculated for each
 Refinement Levels are different corresponding to its cell size.
 The smallest time step corresponds to the Level 1 cells whose timestep
 is calculated as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
CFL=\frac{\Delta x}{c\Delta t\sqrt{3}}=1\implies\Delta t_{L1}=\frac{\Delta x_{L1}}{c\sqrt{3}}=3.46\times10^{-7}\,\text{s}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $c$
\end_inset

 is the sound speed calculated at the reference temperature of 
\begin_inset Formula $276.48\,\text{K}$
\end_inset

.
 For higher Resolution levels whose cells size grows by a factor of 2, the
 timestep also grows by a factor of 2 and hence the time stepping for 
\begin_inset Formula $n^{th}$
\end_inset

resolution level is given by 
\begin_inset Formula $\Delta t|_{Ln}=\Delta t_{L1}\times2^{n-1}$
\end_inset

.
 The total number of time steps required for the simulation is dictated
 by the acoustic measurement requirements.
 For the reference wind tunnel experiment, the spectral resolution obtained
 is 1Hz.
 However this resolution is impossible to simulate since the number of time
 steps are prohibitively high.
 A good compromise is made when the resolution is decreased to 22Hz.
 For this resolution, the number of time steps required is given by the
 discrete Fourier transform theory by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
N_{FFT}=\frac{f_{s}}{\Delta f}
\end{equation}

\end_inset

where 
\begin_inset Formula $N_{FFT}$
\end_inset

 is the number of time steps per averaging window of the Welsch method,
 and 
\begin_inset Formula $f_{s}$
\end_inset

 is the sampling frequency.
 The sampling frequency is determined by the Nyquist-Shannon criterion,
 whereby the sampling rate of the signal must be at least twice the bandwidth
 of interest for the signal.
 This means that for slat noise spectra upto 
\begin_inset Formula $20\text{kHz}$
\end_inset

, the sampling rate must be atleast 
\begin_inset Formula $40\,\text{kHz}$
\end_inset

.
 To avoid the high frequency edge effects close to the edges of the band,
 it is common practice to maintain at least four times the sampling rate
 according to the Nyquist-Shannon criterion.
 In the current case, the FWH propagation region at Refinement Level 4 is
 maintained at the required resolution of 
\begin_inset Formula $1.6\,\text{mm}$
\end_inset

.
 The corresponding time step is hence 
\begin_inset Formula $2^{4-1}=8$
\end_inset

 times the simulation timestep and hence the recordings are done with 
\begin_inset Formula $\Delta t_{FWH}=2.77\times10^{-6}\,\text{s}$
\end_inset

 and the corresponding frequency is 
\begin_inset Formula $\approx360\,\text{kHz}$
\end_inset

.
 However, to obtain a good trade-off between the length of the signal and
 the resolution, we choose to sample the FWH surface at half of this frequency,
 i.e.
 
\begin_inset Formula $f_{s-FWH}\approx180\,\text{kHz}$
\end_inset

.
 The number of time steps then follows as 
\begin_inset Formula $N_{FFT}\approx8200$
\end_inset

 time steps.
\end_layout

\begin_layout Standard
This combined with an averaging requirement for the Welsch algorithm of
 7 averages leads to a total of 
\begin_inset Formula $8200\times7=57400$
\end_inset

 timesteps for recording the flow at Refinement Level 4.
 The number of timesteps at Level 1 then translates to 
\begin_inset Formula $57400\times2^{3}=459200$
\end_inset

.
 An additional transient time is required to remove the initial transients
 in the simulation due to a non-physical initialization of the near wall
 flow.
 The resulting spurious waves need to be allowed to leave the domain to
 reach a converged flow state.
 Moreover, the flow characteristics leading to the acoustics are established
 once the macro-flow converges to steady oscillatory behavior.
 Hence an initial transient of 290000 iterations, equivalent of a physical
 time of approximately 
\begin_inset Formula $0.1\,\text{s}$
\end_inset

 (or more than 16 chord pass times for a stowed chord of 
\begin_inset Formula $0.3\,\text{m}$
\end_inset

 in a flow at 
\begin_inset Formula $50\,\text{m/s}$
\end_inset

) are run before starting the recordings for post processing including FWH.
 This together with the recording timesteps demands a total of 874200 timesteps
 at Refinement level 1 for a simulation.
 
\end_layout

\begin_layout Standard
Additionally, to accelerate the convergence, we utilize the two-step initializat
ion feature available with 
\emph on
ProLB
\emph default
 .
 Accordingly, the simulation initiates without fully resolving the mesh
 but only until Level 2.
 The simulation is then run until a physical time of 0.2 seconds corresponding
 to 144324 iterations at the time step of Refinement Level 2.
 The solver then fully resolves the mesh until Refinement Level 1 and interpolat
es the solution from Level 2 to Level 1, where necessary, to initalise the
 actual simulation.
 
\begin_inset Note Comment
status open

\begin_layout Subsection
Sequential Time-Partitioning for early simulations 
\begin_inset CommandInset label
LatexCommand label
name "subsec:Sequential-Time-Partitioning"

\end_inset


\end_layout

\begin_layout Plain Layout
For the particular case of the validation study that we present in this
 chapter, the simulations were conducted in the early stages of this work.
 Hence the required compute hours to run the simulations for 874200 time
 steps were not readily available.
 For managing the computing resource better, we therefore followed a sequential
 time-partitioning approach where one simulation is split into equal chunks
 of time intervals.
 For this we chose to create chunks which would be consistent with the Welsch
 averaging for the recorded sound spectrum, i.e.
 each chunk of the simulation was made to generate 
\begin_inset Formula $8200$
\end_inset

 time steps at a subsampling factor of 2 for Refinement Level 4, leading
 to total simulated time steps of 
\begin_inset Formula $8200\times2^{3}\times2=131200$
\end_inset

 per chunk.
 
\end_layout

\begin_layout Plain Layout
Furthermore, the restarts were made by recording the macro-variables of
 density and velocities at the last time step of each chunk, to be used
 to reinitialize the simulation for the next chunk.
 Using macro-variables for restarts are not ideal in the LBM setting since
 the restart will then involve conversion of the initial values of the macro
 variables to the probability density distributions of the LBM particles
 and introduces error which are not negligible in view of the acoustics.
 The restarts hence produce an acoustic reset which need an initial transient
 to re-converge to steady dynamics.
 For this an additional 24000 steps of initial transient is used in each
 chunk of the simulation leading to a total of 7 sub-simulations of 155200
 times steps each.
 It must be noted that this approach is only followed for the validation
 case study and for the future simulations leading to the parametric study,
 full simulations with continuous time stepping are utilized due to availability
 of computer resources.
\end_layout

\end_inset


\end_layout

\begin_layout Section

\color black
Simulation with the Wind Tunnel Installations
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Wind Tunnel
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename chapter06_figs/WindTunnel2.png
	lyxscale 40
	width 5cm
	height 5cm
	keepAspectRatio

\end_inset

 
\begin_inset space \qquad{}
\end_inset


\begin_inset Graphics
	filename chapter06_figs/WindTunnelDrawing.png
	lyxscale 30
	width 6cm
	height 6cm
	keepAspectRatio

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Left: The HLD mockup geometry installed on the wind tunnel using lateral
 sides plates.
 Right: A drawing of the dimensions of the wind tunnel nozzle exit.
\begin_inset CommandInset label
LatexCommand label
name "fig:sidewallplates"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The complete configuration of the wind tunnel setup of the original VALIANT
 experiment, which includes the converging duct and the lateral support
 plates, were simulated using the same simulation parameters of the free
 stream simulation.
 This simulation was setup by Airbus engineers (Dr.
 Maxime Itasse and Dr.
 Florian Guiho) and was reproduced at the ECL facility for the purpose of
 testing the version of the code for producing reference data.
 Schematics of the simulation domain and the lateral side plates of the
 same are given in Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:simdomain-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:sidewallplates"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The total physical time of the simulation in our standard free stream configura
tion is 
\begin_inset Formula $0.2\,\text{s}$
\end_inset

 in comparison to 
\begin_inset Formula $0.078\,\text{s}$
\end_inset

 in the current one and is driven by the necessity of computer resources
 while including the wind tunnel geometry meshes.
 With a reduced signal length, the computation leads to spectra with lower
 resolution also.
 The FWH surface was placed inside the cavity covered by the shear layer
 from the nozzle lip, to avoid shear layer vortices crossing the FWH surface.
 The two main differences between a free-stream simulation and a wind-tunnel
 case are that while a spanwise periodic condition is used in the free-stream
 case, a wall boundary is applied in the wind tunnel case mimicking the
 experimental setup, and that the free-stream case is not in a jet but a
 uniform flow.
 Consequently, for spanwise periodic condition, the spanwise acoustic domain
 is theoretically infinite.
 However, the periodic condition numerically copies the data between the
 spanwise boundaries thereby enforcing congruence of the flow variables
 at both boundaries.
 Hence, although the domain is infinite for acoustic propagation, it may
 trigger spurious periodic behaviors in the flow with wavelengths that confer
 to the domain length, i.e a standing pressure wave based on the spanwise
 periodicity might arise in the free stream case even if this is not the
 case in the actual wind-tunnel.
 Another effect of the spanwise periodic condition is that it tends to exert
 spanwise homogeneity in the flow if the spanwise domain length is smaller
 than that which would allow three dimensionality to develop.
 This has been investigated in previous works for the same geometry as that
 used in the present simulations
\begin_inset CommandInset citation
LatexCommand citep
key "Terracol2016"
literal "false"

\end_inset

 and also for other HLD configurations
\begin_inset CommandInset citation
LatexCommand citep
key "Choudhari2007,Choudhari2011,Choudhari2017,Lockard2022,Zhang2024"
literal "false"

\end_inset

.
 
\begin_inset CommandInset citation
LatexCommand citet
key "Lockard2009"
literal "false"

\end_inset

 showed that for the development of three-dimensionality of the coherent
 structures in the cove region, a spanwise extend of 
\begin_inset Formula $0.75c_{s}$
\end_inset

, where 
\begin_inset Formula $c_{s}$
\end_inset

 is the slat chord is necessary.
 For the current case simulated, this corresponds to a length of 
\begin_inset Formula $0.0312\,\text{m}$
\end_inset

 while the actual simulated span length is 
\begin_inset Formula $0.2\,\text{m}$
\end_inset

 corresponding to more than 6 times the suggested value.
 Hence this factor is not expected to affect the features of the flow simulated
 in our case and the three dimensionality is expected to develop unhindered.
\end_layout

\begin_layout Standard
That being the differences between the two cases, the wind tunnel installation
 effects are necessary to explain a few of the disparities between our standard
 free stream simulation and the reference experiment.
 As will be demonstrated in the following chapter, the simulation tends
 to obtain a better agreement with the experiment if the installations are
 included, particularly for the broadband levels and the strength of the
 first tone.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset Float figure
placement !tb
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename chapter06_figs/WindTunnel.png
	lyxscale 40
	width 12cm
	height 12cm
	keepAspectRatio

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
The simulation domain of the wind tunnel geometry with the tunnel and HLD
 installed 
\begin_inset CommandInset label
LatexCommand label
name "fig:simdomain-1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Conclusion
\end_layout

\begin_layout Standard
This chapter in its early development details the Lattice Boltzmann method
 and the basis of its suitability for the aeroacoustic simulations.
 The low dissipation and dispersion characteristics that are implicitly
 available in the LBM schemes are then put to test in the commercial solver
 
\shape italic
ProLB
\shape default
 and a quantitative but empirical characterization of the dissipation performanc
e is obtained.
 Guided by this development, a further reduction of the computation cost
 for noise calculation is achieved by deploying an in-house Ffowcs Williams-Hawk
ings module Turb'AcAn.
 The software was then successfully tested for its accuracy on a Gaussian
 pulse propagation test case.
 In the later part of the chapter, the simulation setup designed to enable
 slat noise investigations using the same framework is detailed.
 The simulation parameters are obtained based on the data available from
 the test cases mentioned and necessary compromises are made to enable computati
onally affordable simulations.
 
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
A high fidelity Lattice Boltzmann solver ProLB was studied and empirically
 tested for basic acoustic propagation behaviors in the early part of this
 chapter.
 Upon validation that the acoustic propagation performance is satisfactory
 and obtaining the necessary mesh requirements for aeroacoustic simulations,
 the solver was used to simulate the acoustics of the 3 element VALIANT
 high-lift geometry in free flow conditions.
 The free-stream velocity is maintained at 
\begin_inset Formula $50,\text{m/s}$
\end_inset

 corresponding to a chord based Reynolds number of 
\begin_inset Formula $10^{6}.$
\end_inset

 The spanwise domain was simulated to have infinite length by using periodic
 conditions.
 The total spanwise length of the free stream simulation was also carefully
 selected such that the spanwise periodic conditions does not induce artificial
 homogeneity in the spanwise direction leading to hindering development
 of the three dimensional features.
 A Ffowcs Williams-Hawkings solver TurbAcAn was then adapted, tested, and
 deployed along with ProLB, to enable farfield noise computation within
 computational constraints.
 The results showed that framework is able to satisfactorily capture the
 acoustic signature of the HLD to high level of accuracy in view of the
 tone frequencies.
 The broadband noise is also found to be in reasonable agreement.
\end_layout

\begin_layout Plain Layout
Primary discrepancies in the free stream simulation compared to the experiment
 was that the main tone at 
\begin_inset Formula $1771\text{Hz}$
\end_inset

, corresponding to the second Rossiter tone, was found to be weaker in the
 free stream simulation.
 Other differences in the flow was such that recirculation strength was
 found to be weaker with a reduced velocity difference across the initial
 shear layer.
 To study these discrepancies, an additional simulation that included the
 full geometry of the VALIANT experimental setup was also used.
 This simulation was initially done for commercial purposes at the Airbus
 Toulouse facility by committing resources required for a very high-fidelity
 simulation of the same HLD configuration together with the wind tunnel
 jet and the shear layer issued by the same.
 The same was reproduced in the Ecole Centrale facility with a reduced total
 simulation length to obtain relevant data.
 The results showed that the inaccuracies in the free stream simulations
 are significantly corrected by inclusion of the wind-tunnel.
 The SPL of the main tone at 
\begin_inset Formula $1771\text{Hz}$
\end_inset

 was recovered to obtain a better agreement with the experiment for the
 farfield observer and for the wall pressure spectra inside the cove.
 For the difference of recirculation velocity, the recirculation speeds
 at the spanwise mid-plane was also seen to improve significantly if the
 lateral side plates are present in the simulation.
\end_layout

\begin_layout Plain Layout
These results using the solver thus shows that the performance of the code
 framework is satisfactory in its fidelity with the experiment.
 The difference in the results being explained as due to the difference
 of flow configuration suggest that the solver is useful in investigating
 the slat flow phenomena and acoustics beyond the limitations of the experiment
 which cannot be designed to remove completely the effect of solid spanwise
 boundaries which are necessary to support the HLD in the wind tunnel.
 For further study of the slat noise phenomena in this thesis, we therefore
 utilize the free stream simulation setup validated in this chapter to generate
 the flow related data for various positions of the slat.
 Nevertheless, before proceeding to run a parametric simulation campaign,
 we take a detour to further investigate the data collected as part of this
 simulation to obtain new and valuable insights into the cove flow phenomenology
 and its related acoustics.
 This investigation is detailed in the upcoming chapter.
\end_layout

\end_inset


\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figs/Slat Config Definition.png
	lyxscale 35
	width 6cm
	height 6cm
	keepAspectRatio

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Schematic of the slat coordinate system with reference to the main element.
 Colored lines are the geometry variations when the slat overlap parameter
 is varied as a fraction of chord length.
 Extracted from the work of 
\begin_inset CommandInset citation
LatexCommand citet
key "Lu2021"
literal "false"

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:coordinates"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Note Comment
status open

\begin_layout Plain Layout
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "/home/amurali/Desktop/References/zoterolibrary"
options "unsrtnat"

\end_inset


\end_layout

\end_inset


\end_layout

\end_body
\end_document
